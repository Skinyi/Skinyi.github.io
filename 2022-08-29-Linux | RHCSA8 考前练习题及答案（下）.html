<!DOCTYPE html>
<html  lang="zh-CN,en,default" >
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    <title>RHCSA8 考前练习题及答案（下） | Avery Ma 的个人网站</title>
    <meta name="description" content="🔴 此文章由之前的 Typora 笔记迁移过来，内容可能已经过时。  附加题：有可能出（ServerA 或 Node1） 添加 sudo 免密操作 允许 sysmgrs 组成员 sudo 时不需要密码。 123456789# visudo 区别于直接改配置文件，退出前有语法检查[root@node1 ~]\# visudo# %wheel        ALL&#x3D;(ALL)       NOPA">
<meta property="og:type" content="article">
<meta property="og:title" content="RHCSA8 考前练习题及答案（下）">
<meta property="og:url" content="https://skinyi.github.io/2022-08-29-Linux%20|%20RHCSA8%20%E8%80%83%E5%89%8D%E7%BB%83%E4%B9%A0%E9%A2%98%E5%8F%8A%E7%AD%94%E6%A1%88%EF%BC%88%E4%B8%8B%EF%BC%89.html">
<meta property="og:site_name" content="Avery Ma 的个人网站">
<meta property="og:description" content="🔴 此文章由之前的 Typora 笔记迁移过来，内容可能已经过时。  附加题：有可能出（ServerA 或 Node1） 添加 sudo 免密操作 允许 sysmgrs 组成员 sudo 时不需要密码。 123456789# visudo 区别于直接改配置文件，退出前有语法检查[root@node1 ~]\# visudo# %wheel        ALL&#x3D;(ALL)       NOPA">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-08-29T15:00:19.147Z">
<meta property="article:modified_time" content="2022-08-29T15:03:16.013Z">
<meta property="article:author" content="skinyi">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="RHEL">
<meta property="article:tag" content="RHCE">
<meta property="article:tag" content="认证考试">
<meta name="twitter:card" content="summary">

    
    <link rel="icon" href="images/favicon.png" type="image/x-icon">

    
<link rel="stylesheet" href="/css/common.min.css">



    
    
    
    
        <link href="//cdn.jsdelivr.net/npm/lightgallery.js@1.1.3/dist/css/lightgallery.min.css" rel="stylesheet">
    
    
    
<link rel="stylesheet" href="/css/iconfont.min.css">

    
<meta name="generator" content="Hexo 6.2.0"></head>

    <body>
        <header class="header header-fixture">
    <div class="profile-search-wrap flex sm:block">
        
        
        <div class="profile sm:text-center md:px-1 lg:px-3 sm:pb-4 sm:pt-6">
            <a id="avatar" role="link" href="https://github.com/skinyi" class="inline-block lg:w-16 lg:h-16 w-8 h-8 m-2" target="_blank" rel="noopener" rel="noreferrer" >
                <img src="/images/avatar.jpg" class="rounded-full" alt="avatar">
            </a>
            <h2 id="name" class="hidden lg:block">Avery Ma</h2>
            <h3 id="title" class="hidden xl:block">IT 从业者</h3>
            
            <small id="location" class="hidden lg:block">
                <i class="iconfont icon-map-icon"></i>
                宁夏, 中国
            </small>
            
        </div>
        
        
<div class="search flex-1 flex lg:inline-block sm:hidden lg:px-4 lg:mt-2 lg:w-full">
    <form id="search-form" class="my-auto flex-1 lg:border lg:border-solid lg:border-gray-200">
        <div class="input-group table bg-gray-100 lg:bg-white w-full">
            <input id="search-input" type="text" placeholder="搜索" class="inline-block w-full bg-gray-100 lg:bg-white">
            <span class="table-cell">
                <button name="search tigger button" disabled>
                    <i class="iconfont icon-search m-2"></i>
                </button>
            </span>
        </div>
    </form>
        
<div id="content-json" data-placeholder="搜索" class="invisible hidden">/content.json</div>
<script id="search-teamplate" type="text/html" data-path="/content.json">
    <div>
        <div class="search-header bg-gray-400">
            <input id="actual-search-input" model="keyword" ref="input" class="inline-block w-full h-10 px-2 py-1" placeholder="搜索" type="text">
        </div>
        <div class="search-result bg-gray-200">
            {{#each searchPosts}}
            <a href="/{{ path }}" class="result-item block px-2 pb-3 mb-1 pt-1 hover:bg-indigo-100">
                <i class="iconfont icon-file"></i>
                <h1 class="result-title inline font-medium text-lg">{{ title }}</h1>
                <p class="result-content text-gray-600 text-sm">{{{ text }}}</p>
            </a>
            {{/each}}
        </div>
    </div>
</script>

</div>


        <button name="menu toogle button" id="menu-toggle-btn" class="block sm:hidden p-3" role="button" aria-expanded="false">
            <i class="iconfont icon-hamburger"></i>
        </button>
    </div>
    <nav id="menu-nav" class="hidden sm:flex flex-col">
        
        
            <div class="menu-item menu-home" role="menuitem">
                <a href="/.">
                    <i class="iconfont icon-home" aria-hidden="true"></i>
                    <span class="menu-title">首页</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-archives" role="menuitem">
                <a href="/archives">
                    <i class="iconfont icon-archive" aria-hidden="true"></i>
                    <span class="menu-title">归档</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-categories" role="menuitem">
                <a href="/categories">
                    <i class="iconfont icon-folder" aria-hidden="true"></i>
                    <span class="menu-title">分类</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-tags" role="menuitem">
                <a href="/tags">
                    <i class="iconfont icon-tag" aria-hidden="true"></i>
                    <span class="menu-title">标签</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-repository" role="menuitem">
                <a href="/repository">
                    <i class="iconfont icon-project" aria-hidden="true"></i>
                    <span class="menu-title">项目</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-about" role="menuitem">
                <a href="/about">
                    <i class="iconfont icon-cup" aria-hidden="true"></i>
                    <span class="menu-title">关于</span>
                </a>
            </div>
        
        

    </nav>
</header>

        <section class="main-section">
            
    <main class="flex-1 px-4 py-14 md:px-5 lg:px-8 lg:py-4 relative min-h-screen">
    

    <article class="content article article-archives article-type-list" itemscope="">
        <header class="article-header">
            
    
        <h1 class="article-title text-lg" itemprop="name">
            RHCSA8 考前练习题及答案（下）
        </h1>
    



            <p class="article-meta mb-3 text-xs">
                <span class="article-date">
    <i class="iconfont icon-calendar-check"></i>
	<a href="/2022-08-29-Linux%20%7C%20RHCSA8%20%E8%80%83%E5%89%8D%E7%BB%83%E4%B9%A0%E9%A2%98%E5%8F%8A%E7%AD%94%E6%A1%88%EF%BC%88%E4%B8%8B%EF%BC%89.html" class="article-date">
	  <time datetime="2022-08-29T15:00:19.147Z" itemprop="datePublished">8月 29</time>
	</a>
</span>

                
    <span class="article-category">
    <i class="iconfont icon-folder"></i>
    <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a> , <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0/Linux/">Linux</a> , <a class="article-category-link" href="/categories/%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/">日常记录</a> , <a class="article-category-link" href="/categories/%E8%BF%81%E7%A7%BB%E6%96%87%E7%AB%A0/">迁移文章</a>
  </span>


                
    <span class="article-tags">
    <i class="iconfont icon-tag"></i>
    <a class="article-tag-none-link" href="/tags/Linux/" rel="tag">Linux</a>, <a class="article-tag-none-link" href="/tags/RHCE/" rel="tag">RHCE</a>, <a class="article-tag-none-link" href="/tags/RHEL/" rel="tag">RHEL</a>, <a class="article-tag-none-link" href="/tags/%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95/" rel="tag">认证考试</a>
  </span>


                
                
    
        <span class="post-wordcount" itemprop="wordCount">字数统计: 2.6k(字)</span>
    
    
        <span class="post-readcount" itemprop="timeRequired">阅读时长: 12(分)</span>
    


            </p>
        </header>
        <div class="marked-body article-body">
            <blockquote>
<p>🔴 此文章由之前的 Typora 笔记迁移过来，内容可能已经过时。</p>
</blockquote>
<h2 id="附加题：有可能出（ServerA-或-Node1）">附加题：有可能出（ServerA 或 Node1）</h2>
<h3 id="添加-sudo-免密操作">添加 sudo 免密操作</h3>
<p>允许 sysmgrs 组成员 sudo 时不需要密码。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">visudo 区别于直接改配置文件，退出前有语法检查</span></span><br><span class="line">[root@node1 ~]\# visudo</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">%wheel        ALL=(ALL)       NOPASSWD: ALL</span></span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash">sysmgrs ALL=(ALL) NOPASSWD: ALL</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试</span></span><br><span class="line">[root@node1 ~]\# su - natasha</span><br><span class="line">[natasha@node1 ~]$ sudo useradd zhangsan</span><br><span class="line">[natasha@node1 ~]$ sudo userdel -r zhangsan</span><br></pre></td></tr></table></figure>
<h3 id="配置创建新用户的密码策略">配置创建新用户的密码策略</h3>
<p>创建新用户时，默认密码策略为 20 天后，密码会过期。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]\# vim /etc/login.defs</span><br><span class="line">PASS_MAX_DAYS 20</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试：</span></span><br><span class="line">[root@node1 ~]\# useradd ligoudan</span><br><span class="line">[root@node1 ~]\# chage -l ligoudan</span><br><span class="line">Last password change : Apr 29, 2021</span><br><span class="line">Password expires : May 19, 2021</span><br><span class="line">Password inactive : never</span><br><span class="line">Account expires : never</span><br><span class="line">Minimum number of days between password change : 0</span><br><span class="line">Maximum number of days between password change : 20</span><br><span class="line">Number of days of warning before password expires : </span><br></pre></td></tr></table></figure>
<h3 id="创建脚本">创建脚本</h3>
<p>创建一个名为 myresearch 的脚本该脚本放置在 /usr/bin 下该脚本用来查找 /usr 下所有小于 10m 且具有修改组 ID 权限的文件，将这些文件放置于/root/myfiles 下</p>
<blockquote>
<p>📌 -size的参数注意 M 大写，k 小写</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]\# vim /usr/bin/myresearch</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">if [ ! -d /root/myfiles ]; then</span><br><span class="line">mkdir /root/myfiles</span><br><span class="line">fi</span><br><span class="line">find /usr -size -10M -perm /g=s -exec cp -a &#123;&#125; /root/myfiles \;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">或者</span></span><br><span class="line">mkdir /root/myfiles </span><br><span class="line">find /usr -size -10M -perm -g=s -exec cp -a &#123;&#125; /root/myfiles \;</span><br><span class="line"></span><br><span class="line">[root@node1 ~]\# chmod +x /usr/bin/myresearch</span><br><span class="line">[root@node1 ~]\# /usr/bin/myresearch</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试</span></span><br><span class="line">[root@node1 ~]\# ll -h /root/myfiles</span><br><span class="line">-rwx--s--x. 1 root slocate 47K Aug 12 2018 locate</span><br><span class="line">-rwx--s--x. 1 root lock 22K Aug 12 2018 lockdev</span><br><span class="line">-r-xr-sr-x. 1 root ssh_keys 464K Nov 26 2018 ssh-keysign</span><br><span class="line">-rwx--s--x. 1 root utmp 13K Aug 12 2018 utempter</span><br><span class="line">-rwxr-sr-x. 1 root tty 23K Dec 11 2018 write</span><br></pre></td></tr></table></figure>
<h3 id="创建脚本-2">创建脚本</h3>
<p>创建一个名为 newsearch 的脚本1、该脚本放置在 /usr/bin 下2、该脚本用来查找 /usr 下所有大于 30k ，但是小于 50k 且具有 SUID 权限的文件，将这些文件放置于 /root/newfiles 下</p>
<blockquote>
<p>📌 UID 权限则为 -u=s 或 /u=s，GID 权限则为 -g=s 或 /g=s</p>
<p>📌 -size 的参数注意 M 大写，k 小写</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建一个文本文件，判断语法以 <span class="keyword">if</span> 开头 <span class="keyword">fi</span> 结尾，-d 检查是否目录</span></span><br><span class="line">[root@node1 ~]\# vim /usr/bin/newsearch</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">if [ ! -d /root/newfiles ];then</span><br><span class="line">mkdir /root/newfiles</span><br><span class="line">fi</span><br><span class="line">find /usr -size +30k -size -50k -perm /u=s -exec cp -a &#123;&#125; /root/newfiles \;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">或者</span></span><br><span class="line">mkdir /root/newfiles</span><br><span class="line">find /usr -size +30k -size -50k -perm /u=s -exec cp -a &#123;&#125; /root/newfiles \;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">所有人都有权限</span></span><br><span class="line">[root@node1 ~]\# chmod +x /usr/bin/newsearch</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行脚本</span></span><br><span class="line">[root@node1 ~]\# /usr/bin/newsearch</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">检查</span></span><br><span class="line">[root@node1 ~]\# ll -h /root/newfiles </span><br><span class="line">-rws--x--x. 1 root root 33K Dec 17 2019 chfn</span><br><span class="line">-rwsr-x---. 1 root cockpit-wsinstance 46K Mar 12 2020 cockpit-session</span><br><span class="line">-rwsr-xr-x. 1 root root 33K Dec 13 2019 passwd</span><br><span class="line">-rwsr-xr-x. 1 root root 33K Dec 17 2019 umount</span><br><span class="line">-rwsr-xr-x. 1 root root 37K Dec 19 2019 unix_chkpwd</span><br><span class="line">-rws--x--x. 1 root root 47K Nov 20 2018</span><br></pre></td></tr></table></figure>
<h3 id="设置默认权限">设置默认权限</h3>
<p>用户 manalo 在 node1 上，所有新创建的文件都应具有 -r--r--r-- 的默认权限，此用户的所有新创建目录应具有 dr-xr-xr-x 的默认权。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]\# su - manalo</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">umask</span> 之间没有等号，~/.bashrc = /home/manalo/.bashrc</span></span><br><span class="line">[manalo@node1 ~]$ vim ~/.bashrc</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">User specific aliases and <span class="built_in">functions</span></span></span><br><span class="line">umask 222</span><br><span class="line">[manalo@node1 ~]$ souce ~/.bashrc # 配置生效</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">检查</span></span><br><span class="line">[manalo@node1 ~]$ touch a.txt</span><br><span class="line">[manalo@node1 ~]$ mkdir dir1</span><br><span class="line">[manalo@node1 ~]$ ll</span><br><span class="line">total 0    -r--r--r--. 1 a a 0 Oct 26 18:04 a.txt    dr-xr-xr-x. 2 a a 6 </span><br></pre></td></tr></table></figure>
<h3 id="配置容器使其自动启动（B-卷）">配置容器使其自动启动（B 卷）</h3>
<p>利用注册服务器上的 rsyslog 镜像，创建一个名为 logger 的容器</p>
<ol>
<li>面向 wallah 用户，配置一个 systemd 服务</li>
<li>该服务命名为 <code>container-logger</code> ，并在系统重启时自动启动，无需干预</li>
<li>将服务配置为在启动时自动将 /home/wallah/var_log` 挂载到容器中的 /var/log 下</li>
<li>在容器中执行命令 podman exec logger logger -p <a target="_blank" rel="noopener" href="http://authpriv.info">authpriv.info</a> SUIBIAN</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]\# ssh wallah@node1</span><br><span class="line">[wallah@node1 ~]$ podman login -u admin -p redhat321</span><br><span class="line">login Succeeded!</span><br><span class="line">[wallah@node1 ~]$ podman search registry.domain250.example.com/</span><br><span class="line">INDEX NAME DESCRIPTION STARS OFFICIAL AUTOMATED</span><br><span class="line">example.com registry.domain250.example.com/rhel8/rsyslog 0</span><br><span class="line">[wallah@node1 ~]$ podman run -d --name logger -v /home/wallah/var_log:/var/log:Z registry.domain250.example.com/rhel8/rsyslog</span><br><span class="line">[wallah@node1 ~]$ podman stop logger</span><br><span class="line">[wallah@node1 ~]$ loginctl enable-linger</span><br><span class="line">[wallah@node1 ~]$ loginctl show-user wallah</span><br><span class="line">[wallah@node1 ~]$ mkdir -p ~/.config/systemd/user/</span><br><span class="line">[wallah@node1 ~]$ cd ~/.config/systemd/user/</span><br><span class="line">[wallah@node1 ~]$ podman generate systemd -n logger -f</span><br><span class="line">[wallah@node1 ~]$ systemctl --user enable --now container-logger</span><br><span class="line">[wallah@node1 ~]$ systemctl --user status container-logger</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试</span></span><br><span class="line">[wallah@node1 ~]$ podman exec logger logger -p authpriv.info SUIBIAN</span><br><span class="line">[wallah@node1 ~]$ grep SUIBIAN /home/wallah/var_log/secure</span><br><span class="line">2021-08-13T11:45:37.824980+00:00 574761d4236a root: SUIBIAN</span><br><span class="line">[wallah@node1 ~]$ exit</span><br><span class="line">[root@node1 ~]\# reboot</span><br><span class="line">[root@node1 ~]\# ps -aux | grep podman</span><br></pre></td></tr></table></figure>
<h3 id="容器-nginx">容器 nginx</h3>
<p>利用注册服务器上的 nginx 镜像，创建一个名为 nginx 的容器</p>
<ol>
<li>
<p>面向 wallah 用户，配置一个 systemd 服务</p>
<p>该服务命名为 <code>container-nginx</code>，并在系统重启时自动启动，无需干预</p>
</li>
<li>
<p>在 /home/wallah/www 下创建文件 index.html ，内容为 hello nginx</p>
</li>
<li>
<p>将服务配置为在启动时自动将 /home/wallah/www 挂载到容器中的 /usr/share/nginx/html 下将容器主机上的端口 8080 映射到容器上的端口 80</p>
</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]\# ssh wallah@node1</span><br><span class="line">[wallah@node1 ~]$</span><br><span class="line">[wallah@node1 ~]$ podman login registry.domain250.example.com</span><br><span class="line">Username: admin</span><br><span class="line">Password: redhat321</span><br><span class="line">login Succeeded!</span><br><span class="line">[wallah@node1 ~]$ podman search registry.domain250.example.com/</span><br><span class="line">INDEX NAME DESCRIPTION STARS OFFICIAL AUTOMATED    </span><br><span class="line">example.com registry.domain250.example.com/library/nginx 0</span><br><span class="line"></span><br><span class="line">[wallah@node1 ~]$ mkdir /home/wallah/www    </span><br><span class="line">[wallah@node1 ~]$ echo &quot;hello nginx&quot; &gt; /home/wallah/www/index.html    </span><br><span class="line">[wallah@node1 ~]$ podman run -d --name nginx -v /home/wallah/www:/usr/share/nginx.html:Z -p 8080:80 registry.domain250.example.com/library/nginx</span><br><span class="line"></span><br><span class="line">[wallah@node1 ~]$ loginctl enable-linger    </span><br><span class="line">[wallah@node1 ~]$ loginctl show-user wallah</span><br><span class="line"></span><br><span class="line">[wallah@node1 ~]$ mkdir -p ~/.config/systemd/user/</span><br><span class="line">[wallah@node1 ~]$ cd ~/.config/systemd/user/</span><br><span class="line">[wallah@node1 ~]$ podman generate systemd -n nginx -f</span><br><span class="line">[wallah@node1 ~]$ podman stop nginx</span><br><span class="line">[wallah@node1 ~]$ systemctl --user enable --now container-nginx </span><br><span class="line">[wallah@node1 ~]$ systemctl --user status container-nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试</span></span><br><span class="line">[wallah@node1 ~]$ curl localhost:8080</span><br><span class="line">hello nginx</span><br><span class="line">[wallah@node1 ~]$ exit</span><br><span class="line">[wallah@node1 ~]\# reboot</span><br><span class="line">[wallah@node1 ~]\# curl localhost:8080</span><br><span class="line">[wallah@node1 ~]\# ss -antup | grep 8080</span><br><span class="line">[wallah@node1 ~]\# ps -aux | grep</span><br></pre></td></tr></table></figure>
<h2 id="在-Node2-上完成以下任务">在 Node2 上完成以下任务</h2>
<h3 id="重置-root-密码">重置 root 密码</h3>
<p>将 node2 主机的密码设置成 redhat。你需要获得系统访问权限才能进行此操作。</p>
<p><strong>答案</strong>：重新启动机器，进入 grub 界面后按 <code>e</code> 进入启动配置文件编辑界面，在 linux 命令行前的启动选项后面增加 <code>rd.break</code>，按 <strong>CTRL + X</strong> 键保存并退出编辑。然后进行以下操作：</p>
<ol>
<li>以 <b>读+写</b> 形式重新挂载 <em>/sysroot</em>；</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">switch_root:\<span class="comment"># mount -o remount,rw /sysroot</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>切换为 <code>chroot</code> 存放位置，其中 <em>/sysroot</em> 被视为文件系统树的根；</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">switch_root:\<span class="comment"># chroot /sysroot</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>设置新 root 密码；</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh-4.4\<span class="comment"># echo redhat | passwd --stdin root</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>确保所有未标记的文件（包括此时的 <em>/etc/shadow</em>）在启动过程中都会重新获得标记；</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh-4.4\<span class="comment"># touch /.autorelabel</span></span><br></pre></td></tr></table></figure>
<ol start="5">
<li>键入 <code>exit</code> 命令并执行两次，分别退出 <code>chroot</code> 和 <em>initramfs</em> shell。</li>
</ol>
<p>此时，系统将继续进行启动，执行完整的 SELinux 重新标记，然后再次重新启动。</p>
<h3 id="配置-YUM-源">配置 YUM 源</h3>
<p>给系统配置默认存储库，要求如下：</p>
<p>YUM 的 两 个 存 储 库 的 地 址 分 别 是 ： <a href="ftp://host.domain8.example.com/dvd/BaseOS">ftp://host.domain8.example.com/dvd/BaseOS</a> 和 <a href="ftp://host.domain8.example.com/dvd/AppStream">ftp://host.domain8.example.com/dvd/AppStream</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 见 ServerA 配置 yum/dnf 仓库部分 或：</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># scp root@server1:/etc/yum.repos.d/Default.repo /etc/yum.repos.d/</span></span><br></pre></td></tr></table></figure>
<h3 id="调整逻辑卷的大小">调整逻辑卷的大小</h3>
<p>将名字为 vo 的逻辑卷的大小调整到 200MiB，确保文件系统的内容保持不变。调整后的逻辑卷的大小范围在 180MiB 到 220MiB 的范围内都是可以接受的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]\<span class="comment"># df -h</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># vgs myvol    # 查看 vo 存储组的信息</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># lvextend -L 200M /dev/myvol/vo    # 将逻辑卷 vo 的大小正好调整为 200MiB</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># resize2fs /dev/myvol/vo    # 扩展 vo 的文件系统大小</span></span><br></pre></td></tr></table></figure>
<h3 id="创建交换分区">创建交换分区</h3>
<p>向 node2 添加一个额外的交换分区 756MiB。交换分区应在系统启动时自动挂载。不要删除或以任何方式改动系统上的任何现有交换分区。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]\<span class="comment"># lsblk    # 查看存储信息，以规划交换分区的位置</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># fdisk /dev/sdb</span></span><br><span class="line"></span><br><span class="line">Welcome to fdisk (util-linux 2.32.1).</span><br><span class="line">Changes will remain <span class="keyword">in</span> memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): n</span><br><span class="line">Partition <span class="built_in">type</span></span><br><span class="line">   p   primary (2 primary, 0 extended, 2 free)</span><br><span class="line">   e   extended (container <span class="keyword">for</span> logical partitions)</span><br><span class="line">Select (default p): p</span><br><span class="line">Partition number (3,4, default 3): </span><br><span class="line">First sector (2095106-8388607, default 2097152): </span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G,T,P&#125; (2097152-8388607, default 8388607): +756M</span><br><span class="line"></span><br><span class="line">Created a new partition 3 of <span class="built_in">type</span> <span class="string">&#x27;Linux&#x27;</span> and of size 756 MiB.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): w</span><br><span class="line">The partition table has been altered.</span><br><span class="line">Syncing disks.</span><br><span class="line"></span><br><span class="line">[root@node2 ~]\<span class="comment"># mkswap /dev/vdb3    # 标记交换分区,查看新创建的交换分区的 UUID</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># vim /etc/fstab    # 写入 fstab 文件</span></span><br><span class="line">UUID=<span class="string">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span>    swap    swap    defaults    0    0</span><br><span class="line">[root@node2 ~]\<span class="comment"># swapon -a    # 启用交换分区</span></span><br></pre></td></tr></table></figure>
<h3 id="创建逻辑卷">创建逻辑卷</h3>
<p>根据如下要求，创建新的逻辑卷：</p>
<ol>
<li>逻辑卷的名字是 db，卷组是 dbgroup，大小是 60 个 PE size</li>
<li>dbgroup 的 PE size 是 16MiB</li>
<li>格式化成 xfs 文件系统。并在系统启动时自动挂载到 /mnt/data</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]\<span class="comment"># lsblk    # 查看存储信息，以规划逻辑卷的位置</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># fdisk /dev/vdb    # 创建主分区</span></span><br><span class="line"></span><br><span class="line">Welcome to fdisk (util-linux 2.32.1).</span><br><span class="line">Changes will remain <span class="keyword">in</span> memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): n</span><br><span class="line">Partition <span class="built_in">type</span></span><br><span class="line">   p   primary (3 primary, 0 extended, 1 free)</span><br><span class="line">   e   extended (container <span class="keyword">for</span> logical partitions)</span><br><span class="line">Select (default e): p</span><br><span class="line"></span><br><span class="line">Selected partition 4</span><br><span class="line">First sector (2095106-8388607, default 3645440): </span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G,T,P&#125; (3645440-8388607, default 8388607): </span><br><span class="line"></span><br><span class="line">Created a new partition 4 of <span class="built_in">type</span> <span class="string">&#x27;Linux&#x27;</span> and of size 2.3 GiB.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): w</span><br><span class="line">The partition table has been altered.</span><br><span class="line">Syncing disks.</span><br><span class="line"></span><br><span class="line">[root@node2 ~]\<span class="comment"># pvcreate /dev/vdb4    # 将 /dev/vdb? 创建为物理卷</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># vgcreate -s 16M dbgroup /dev/vdb4    # 创建卷组 dbgroup，PE 大小为 16MiB,并将 /dev/vdb? 加入</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># lvcreate -l 60 -n db dbgroup    # 从卷组 dbgroup 创建逻辑卷，大小是 60 个物理区块，名字是 db</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># mkfs.xfs /dev/dbgroup/db    # 为逻辑卷创建文件系统</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># mkdir /mnt/data    # 创建挂载点</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># blkid /dev/dbgroup/db    # 查看逻辑卷的 UUID</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># vim /etc/fstab    # 编辑 fstab，添加挂在信息</span></span><br><span class="line">UUID=<span class="string">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span>    /mnt/data    xfs    defaults     0    0</span><br><span class="line">[root@node2 ~]\<span class="comment"># mount -a    # 立即挂载</span></span><br></pre></td></tr></table></figure>
<h3 id="创建-vdo-卷">创建 vdo 卷</h3>
<p>根据如下要求，创建新的 VDO 卷：</p>
<ol>
<li>使用未分区的磁盘</li>
<li>该卷的名称为 vdotest</li>
<li>该卷的逻辑大小是 50G</li>
<li>该卷使用 xfs 文件系统格式化</li>
<li>该卷在系统启动时挂载到 /mnt/vdotest</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]\<span class="comment"># lsblk    # 查看存储信息，以下假设 /dev/vdc 还未分区</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># yum install vdo kmod-kvdo    # 若未安装 vdo、kmod-kvdo 则需要安装</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># vdo create --name=vdotest --device=/dev/vdc --vdoLogicalSize=50G    # 创建 vdo 卷</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># mkfs.xfs -K /dev/mapper/vdotest    # 格式化该 vdo 卷</span></span><br><span class="line"><span class="comment"># 挂载方法一</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># udevadm settle    # 自动挂载</span></span><br><span class="line"><span class="comment"># 挂载方法二</span></span><br><span class="line">[root@node2 ~]\<span class="comment"># mkdir /mnt/vdotest; blkid /dev/mapper/vdotest; vim /etc/fstab    # 手动挂载</span></span><br><span class="line">UUID=<span class="string">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span>    /mnt/vdotest    defaults, _netdev    0 0</span><br><span class="line">[root@node2 ~]\<span class="comment"># mount -a</span></span><br></pre></td></tr></table></figure>
<h3 id="配置系统调优">配置系统调优</h3>
<p>为你的系统选择建议的’tuned’配置集并将它设置为默认设置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]\<span class="comment"># tuned-adm recommend     # 查看推荐设置</span></span><br><span class="line">virtual-guest</span><br><span class="line">[root@node2 ~]\<span class="comment"># tuned-adm profile virtual-guest    # 设置推荐设置为默认</span></span><br></pre></td></tr></table></figure>

        </div>
        
<blockquote class="copyright">
    <p><strong>本文链接 : </strong><a class="permalink" href="https://skinyi.github.io/2022-08-29-Linux%20|%20RHCSA8%20%E8%80%83%E5%89%8D%E7%BB%83%E4%B9%A0%E9%A2%98%E5%8F%8A%E7%AD%94%E6%A1%88%EF%BC%88%E4%B8%8B%EF%BC%89.html">https://skinyi.github.io/2022-08-29-Linux | RHCSA8 考前练习题及答案（下）.html</a></p>
    <p><strong>这篇文章由作者胡编乱造或者由其他文章复制粘贴而来，其中有些内容可能已经过时，请谨慎参考复制文章中的内容。</strong></p>
</blockquote>


    </article>
    
    <section id="comments">
        
    </section>


    

</main>


<aside style="" id="sidebar" class="aside aside-fixture">
    <div class="toc-sidebar">
        <nav id="toc" class="article-toc">
            <h3 class="toc-title">文章目录</h3>
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%8A%A0%E9%A2%98%EF%BC%9A%E6%9C%89%E5%8F%AF%E8%83%BD%E5%87%BA%EF%BC%88ServerA-%E6%88%96-Node1%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">附加题：有可能出（ServerA 或 Node1）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0-sudo-%E5%85%8D%E5%AF%86%E6%93%8D%E4%BD%9C"><span class="toc-number">1.1.</span> <span class="toc-text">添加 sudo 免密操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%88%9B%E5%BB%BA%E6%96%B0%E7%94%A8%E6%88%B7%E7%9A%84%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5"><span class="toc-number">1.2.</span> <span class="toc-text">配置创建新用户的密码策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%84%9A%E6%9C%AC"><span class="toc-number">1.3.</span> <span class="toc-text">创建脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%84%9A%E6%9C%AC-2"><span class="toc-number">1.4.</span> <span class="toc-text">创建脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E6%9D%83%E9%99%90"><span class="toc-number">1.5.</span> <span class="toc-text">设置默认权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%AE%B9%E5%99%A8%E4%BD%BF%E5%85%B6%E8%87%AA%E5%8A%A8%E5%90%AF%E5%8A%A8%EF%BC%88B-%E5%8D%B7%EF%BC%89"><span class="toc-number">1.6.</span> <span class="toc-text">配置容器使其自动启动（B 卷）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8-nginx"><span class="toc-number">1.7.</span> <span class="toc-text">容器 nginx</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8-Node2-%E4%B8%8A%E5%AE%8C%E6%88%90%E4%BB%A5%E4%B8%8B%E4%BB%BB%E5%8A%A1"><span class="toc-number">2.</span> <span class="toc-text">在 Node2 上完成以下任务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E7%BD%AE-root-%E5%AF%86%E7%A0%81"><span class="toc-number">2.1.</span> <span class="toc-text">重置 root 密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-YUM-%E6%BA%90"><span class="toc-number">2.2.</span> <span class="toc-text">配置 YUM 源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E6%95%B4%E9%80%BB%E8%BE%91%E5%8D%B7%E7%9A%84%E5%A4%A7%E5%B0%8F"><span class="toc-number">2.3.</span> <span class="toc-text">调整逻辑卷的大小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%BA%A4%E6%8D%A2%E5%88%86%E5%8C%BA"><span class="toc-number">2.4.</span> <span class="toc-text">创建交换分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%80%BB%E8%BE%91%E5%8D%B7"><span class="toc-number">2.5.</span> <span class="toc-text">创建逻辑卷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-vdo-%E5%8D%B7"><span class="toc-number">2.6.</span> <span class="toc-text">创建 vdo 卷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F%E8%B0%83%E4%BC%98"><span class="toc-number">2.7.</span> <span class="toc-text">配置系统调优</span></a></li></ol></li></ol>
        </nav>
    </div>
</aside>





        </section>
        <footer class="hidden lg:block fixed bottom-0 left-0 sm:w-1/12 bg-gray-100 z-40">
    
    
        <p class="footer-custom">❤ Powered by <a href="https://hexo.io/" target="_blank" rel="noopener noreferrer">Hexo</a> with <a href="https://github.com/fengkx/hexo-theme-purer" target="_blank" rel="noopener noreferrer">Purer theme</a>.</p>
    
</footer>

        <div id="mask" class="hidden mask fixed inset-0 bg-gray-900 opacity-75 z-40"></div>
        <div id="search-view-container" class="hidden shadow-xl"></div>
        
<script src="/js/dom-event.min.js"></script>



<script src="/js/local-search.min.js"></script>



    <script src="//cdn.jsdelivr.net/npm/lightgallery.js@1.1.3/dist/js/lightgallery.min.js"></script>
    
<script src="/js/light-gallery.min.js"></script>






    </body>
</html>
