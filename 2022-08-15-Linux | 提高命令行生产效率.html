<!DOCTYPE html>
<html  lang="zh-CN,en,default" >
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    <title>提高命令行生产效率 | Avery Ma 的个人网站</title>
    <meta name="description" content="🔴 此文章由之前的 Typora 笔记迁移过来，内容可能已经过时。  编写简单的 BASH 脚本 ​Shell 脚本可以大幅提高工作效率，对处理重复、复杂的任务很有用。精通 Shell 脚本编写是 Linux 从业者的基本要求。 ​Shell 脚本是一个可执行文件，其内容是一系列命令和逻辑的集合。 ​Shell 脚本的第一行以 “#!” 开头，后面跟为执行该脚本的内容时所需要的正确的命令解释器">
<meta property="og:type" content="article">
<meta property="og:title" content="提高命令行生产效率">
<meta property="og:url" content="https://skinyi.github.io/2022-08-15-Linux%20|%20%E6%8F%90%E9%AB%98%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%94%9F%E4%BA%A7%E6%95%88%E7%8E%87.html">
<meta property="og:site_name" content="Avery Ma 的个人网站">
<meta property="og:description" content="🔴 此文章由之前的 Typora 笔记迁移过来，内容可能已经过时。  编写简单的 BASH 脚本 ​Shell 脚本可以大幅提高工作效率，对处理重复、复杂的任务很有用。精通 Shell 脚本编写是 Linux 从业者的基本要求。 ​Shell 脚本是一个可执行文件，其内容是一系列命令和逻辑的集合。 ​Shell 脚本的第一行以 “#!” 开头，后面跟为执行该脚本的内容时所需要的正确的命令解释器">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-08-15T04:31:08.599Z">
<meta property="article:modified_time" content="2022-08-15T04:35:30.416Z">
<meta property="article:author" content="skinyi">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="RHEL">
<meta property="article:tag" content="RHCE">
<meta property="article:tag" content="认证考试">
<meta name="twitter:card" content="summary">

    
    <link rel="icon" href="images/favicon.png" type="image/x-icon">

    
<link rel="stylesheet" href="/css/common.min.css">



    
    
    
    
        <link href="//cdn.jsdelivr.net/npm/lightgallery.js@1.1.3/dist/css/lightgallery.min.css" rel="stylesheet">
    
    
    
<link rel="stylesheet" href="/css/iconfont.min.css">

    
<meta name="generator" content="Hexo 6.2.0"></head>

    <body>
        <header class="header header-fixture">
    <div class="profile-search-wrap flex sm:block">
        
        
        <div class="profile sm:text-center md:px-1 lg:px-3 sm:pb-4 sm:pt-6">
            <a id="avatar" role="link" href="https://github.com/skinyi" class="inline-block lg:w-16 lg:h-16 w-8 h-8 m-2" target="_blank" rel="noopener" rel="noreferrer" >
                <img src="/images/avatar.jpg" class="rounded-full" alt="avatar">
            </a>
            <h2 id="name" class="hidden lg:block">Avery Ma</h2>
            <h3 id="title" class="hidden xl:block">IT 从业者</h3>
            
            <small id="location" class="hidden lg:block">
                <i class="iconfont icon-map-icon"></i>
                宁夏, 中国
            </small>
            
        </div>
        
        
<div class="search flex-1 flex lg:inline-block sm:hidden lg:px-4 lg:mt-2 lg:w-full">
    <form id="search-form" class="my-auto flex-1 lg:border lg:border-solid lg:border-gray-200">
        <div class="input-group table bg-gray-100 lg:bg-white w-full">
            <input id="search-input" type="text" placeholder="搜索" class="inline-block w-full bg-gray-100 lg:bg-white">
            <span class="table-cell">
                <button name="search tigger button" disabled>
                    <i class="iconfont icon-search m-2"></i>
                </button>
            </span>
        </div>
    </form>
        
<div id="content-json" data-placeholder="搜索" class="invisible hidden">/content.json</div>
<script id="search-teamplate" type="text/html" data-path="/content.json">
    <div>
        <div class="search-header bg-gray-400">
            <input id="actual-search-input" model="keyword" ref="input" class="inline-block w-full h-10 px-2 py-1" placeholder="搜索" type="text">
        </div>
        <div class="search-result bg-gray-200">
            {{#each searchPosts}}
            <a href="/{{ path }}" class="result-item block px-2 pb-3 mb-1 pt-1 hover:bg-indigo-100">
                <i class="iconfont icon-file"></i>
                <h1 class="result-title inline font-medium text-lg">{{ title }}</h1>
                <p class="result-content text-gray-600 text-sm">{{{ text }}}</p>
            </a>
            {{/each}}
        </div>
    </div>
</script>

</div>


        <button name="menu toogle button" id="menu-toggle-btn" class="block sm:hidden p-3" role="button" aria-expanded="false">
            <i class="iconfont icon-hamburger"></i>
        </button>
    </div>
    <nav id="menu-nav" class="hidden sm:flex flex-col">
        
        
            <div class="menu-item menu-home" role="menuitem">
                <a href="/.">
                    <i class="iconfont icon-home" aria-hidden="true"></i>
                    <span class="menu-title">首页</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-archives" role="menuitem">
                <a href="/archives">
                    <i class="iconfont icon-archive" aria-hidden="true"></i>
                    <span class="menu-title">归档</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-categories" role="menuitem">
                <a href="/categories">
                    <i class="iconfont icon-folder" aria-hidden="true"></i>
                    <span class="menu-title">分类</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-tags" role="menuitem">
                <a href="/tags">
                    <i class="iconfont icon-tag" aria-hidden="true"></i>
                    <span class="menu-title">标签</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-repository" role="menuitem">
                <a href="/repository">
                    <i class="iconfont icon-project" aria-hidden="true"></i>
                    <span class="menu-title">项目</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-about" role="menuitem">
                <a href="/about">
                    <i class="iconfont icon-cup" aria-hidden="true"></i>
                    <span class="menu-title">关于</span>
                </a>
            </div>
        
        

    </nav>
</header>

        <section class="main-section">
            
    <main class="flex-1 px-4 py-14 md:px-5 lg:px-8 lg:py-4 relative min-h-screen">
    

    <article class="content article article-archives article-type-list" itemscope="">
        <header class="article-header">
            
    
        <h1 class="article-title text-lg" itemprop="name">
            提高命令行生产效率
        </h1>
    



            <p class="article-meta mb-3 text-xs">
                <span class="article-date">
    <i class="iconfont icon-calendar-check"></i>
	<a href="/2022-08-15-Linux%20%7C%20%E6%8F%90%E9%AB%98%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%94%9F%E4%BA%A7%E6%95%88%E7%8E%87.html" class="article-date">
	  <time datetime="2022-08-15T04:31:08.599Z" itemprop="datePublished">8月 15</time>
	</a>
</span>

                
    <span class="article-category">
    <i class="iconfont icon-folder"></i>
    <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a> , <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0/Linux/">Linux</a> , <a class="article-category-link" href="/categories/%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/">日常记录</a> , <a class="article-category-link" href="/categories/%E8%BF%81%E7%A7%BB%E6%96%87%E7%AB%A0/">迁移文章</a>
  </span>


                
    <span class="article-tags">
    <i class="iconfont icon-tag"></i>
    <a class="article-tag-none-link" href="/tags/Linux/" rel="tag">Linux</a>, <a class="article-tag-none-link" href="/tags/RHCE/" rel="tag">RHCE</a>, <a class="article-tag-none-link" href="/tags/RHEL/" rel="tag">RHEL</a>, <a class="article-tag-none-link" href="/tags/%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95/" rel="tag">认证考试</a>
  </span>


                
                
    
        <span class="post-wordcount" itemprop="wordCount">字数统计: 2.7k(字)</span>
    
    
        <span class="post-readcount" itemprop="timeRequired">阅读时长: 12(分)</span>
    


            </p>
        </header>
        <div class="marked-body article-body">
            <blockquote>
<p>🔴 此文章由之前的 Typora 笔记迁移过来，内容可能已经过时。</p>
</blockquote>
<h2 id="编写简单的-BASH-脚本">编写简单的 BASH 脚本</h2>
<p>​Shell 脚本可以大幅提高工作效率，对处理重复、复杂的任务很有用。精通 Shell 脚本编写是 Linux 从业者的基本要求。</p>
<p>​Shell 脚本是一个可执行文件，其内容是一系列命令和逻辑的集合。</p>
<p>​Shell 脚本的第一行以 “#!” 开头，后面跟为执行该脚本的内容时所需要的正确的命令解释器的绝对路径，如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br></pre></td></tr></table></figure>
<p>​Shell 脚本必须被赋予执行权限，才能作为常规命令运行。使用 <code>chmod</code> 命令可为其添加执行权限，并且可能需要与 <code>chown</code> 命令组合来更改脚本的文件所有权，仅为脚本的目标用户授予执行权限。</p>
<p>​将脚本放在 shell 的 <em>PATH</em> 环境变量中所列出的某个目录下，则可以像其他命令那样单独用文件名来调用 shell 脚本。但应注意自己编写的脚本名需要区别于 linux 系统命令或已有的脚本文件。</p>
<h3 id="编写脚本的两个须知点">编写脚本的两个须知点</h3>
<h4 id="特殊字符的字面化处理">特殊字符的字面化处理</h4>
<p>​一些字符或词语对 shell 来说有特殊含义，在使用这些字符和词语的时候如果只想用其字面值的话则需要以下三种方法来取消或转义对应特殊字符或词语。</p>
<p>​前缀转义字符来输出 # 号：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># echo #1 is here</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]\<span class="comment"># echo \#1 is here</span></span><br><span class="line">\<span class="comment">#1 is here    # md 格式冲突，请忽略输出结果中的转义符号，下同</span></span><br></pre></td></tr></table></figure>
<p>使用单引号括起需要多次转义的语句而不用分别进行转义：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># echo \#1 is here, but where is \#2?</span></span><br><span class="line">\<span class="comment">#1 is here, but where is \#2?</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># echo &#x27;#1 is here, but where is #2&#x27;</span></span><br><span class="line">\<span class="comment">#1 is here, but where is \#2</span></span><br></pre></td></tr></table></figure>
<p>​使用双引号可以阻止通配和 shell 扩展，但依然允许命令和变量替换，单引号则进一步不允许命令和变量替换。问号也是一个需要防止扩展的元字符。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># var=$(hostname -s); echo $var    # 将命令的执行结果进行变量赋值： VAR=$&#123;COMMAND&#125;</span></span><br><span class="line">localhost</span><br><span class="line">[root@localhost ~]\<span class="comment"># echo &quot;****** hostname is $&#123;var&#125; ******&quot;</span></span><br><span class="line">****** hostname is localhost ******</span><br><span class="line">[root@localhost ~]\<span class="comment"># echo Your username variable is \$USER.    # 对 $ 进行了转义、因而 $ 失去了原有作用</span></span><br><span class="line">Your username variable is <span class="variable">$USER</span>.</span><br><span class="line">[root@localhost ~]\<span class="comment"># echo &quot;Variable $var is evaluate to $(hostname -s)&quot;</span></span><br><span class="line">Variable localhost is evaluate to localhost</span><br><span class="line">[root@localhost ~]\<span class="comment"># echo &#x27;Variable $var is evaluate to $(hostname -s)&#x27;</span></span><br><span class="line">Variable <span class="variable">$var</span> is evaluate to $(hostname -s)</span><br><span class="line">[root@localhost ~]\<span class="comment"># echo &quot;\&quot;Hello,world and $var\&quot;&quot;; echo &#x27;&quot;Hello,world and $var&quot;&#x27;</span></span><br><span class="line"><span class="string">&quot;Hello,world and localhost&quot;</span></span><br><span class="line"><span class="string">&quot;Hello,world and <span class="variable">$var</span>&quot;</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># echo &quot;&#x27;Hello,world and $var&#x27;&quot;; echo \&quot;&quot;Hello,world and $var&quot;\&quot;</span></span><br><span class="line"><span class="string">&#x27;Hello,world and localhost&#x27;</span></span><br><span class="line"><span class="string">&quot;Hello,world and localhost&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="多使用-echo-命令来输出执行状态信息">多使用 <code>echo</code> 命令来输出执行状态信息</h4>
<p>​最好将普通提示信息输出至标准输出，而将错误信息输出至错误输出。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">......</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Something has done!&quot;</span>;</span><br><span class="line">......</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Error: Something went wrong and need to exit!&quot;</span> &gt;&amp;2;</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<h3 id="脚本编写之循环">脚本编写之循环</h3>
<p>​Bash 的 <em>for</em> 循环结构使用以下语法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> VARIABLE <span class="keyword">in</span> LIST; <span class="keyword">do</span></span><br><span class="line">COMMAND VARIABLE</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>​以下语句的输出结果是一样的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语句一</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># for HOST in host1 host2 host3; do echo $HOST; done</span></span><br><span class="line"><span class="comment"># 语句二</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># for HOST in host&#123;1,2,3&#125;; do echo $HOST; done</span></span><br><span class="line"><span class="comment"># 语句三</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># for HOST in host&#123;1...3&#125;; do echo $HOST; done</span></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">host1</span><br><span class="line">host2</span><br><span class="line">host3</span><br></pre></td></tr></table></figure>
<p>​查询安装的跟内核相关的包并输出其安装时间：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># for PKG in $(rpm -qa | grep &quot;kernel&quot;); \</span></span><br><span class="line"><span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$PKG</span> was installed in <span class="subst">$(date -d @$(rpm -q --qf <span class="string">&quot;%&#123;INSTALLTIME&#125;\n&quot;</span> $PKG)</span>)&quot;</span>; \</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">kernel-tools-4.18.0-240.el8.x86_64 was installed <span class="keyword">in</span> Thu Jun  3 07:08:19 CST 2021</span><br><span class="line">kernel-core-4.18.0-240.el8.x86_64 was installed <span class="keyword">in</span> Thu Jun  3 07:05:38 CST 2021</span><br><span class="line">kernel-tools-libs-4.18.0-240.el8.x86_64 was installed <span class="keyword">in</span> Thu Jun  3 07:04:20 CST 2021</span><br><span class="line">abrt-addon-kerneloops-2.10.9-20.el8.x86_64 was installed <span class="keyword">in</span> Thu Jun  3 07:08:21 CST 2021</span><br><span class="line">kernel-modules-4.18.0-240.el8.x86_64 was installed <span class="keyword">in</span> Thu Jun  3 07:06:03 CST 2021</span><br><span class="line">kernel-devel-4.18.0-240.el8.x86_64 was installed <span class="keyword">in</span> Thu Jun  3 07:10:07 CST 2021</span><br><span class="line">kernel-4.18.0-240.el8.x86_64 was installed <span class="keyword">in</span> Thu Jun  3 07:09:28 CST 2021</span><br><span class="line">kernel-headers-4.18.0-240.el8.x86_64 was installed <span class="keyword">in</span> Thu Jun  3 07:04:49 CST 2021</span><br><span class="line"><span class="comment"># date -d @时间戳    # 将某一时间戳（1970 年 01 月 01 日 08 时整起经过的秒数）转换成标准日期格式</span></span><br></pre></td></tr></table></figure>
<p>​输出 2 - 10 之间的所有偶数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># for EVEN in $(seq 2 2 10); do echo &quot;$EVEN&quot;; done</span></span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line">10</span><br><span class="line"><span class="comment"># seq 命令：生成数字序列。seq 2 2 10，从 2 开始，每次增加 2，直至 10。</span></span><br></pre></td></tr></table></figure>
<p>​一个疑问：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这是为啥？</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># for VAR in var&#123;$(seq -s , 0 1 5)&#125;; do echo $VAR; done</span></span><br><span class="line">var&#123;0,1,2,3,4,5&#125;</span><br><span class="line">[root@localhost ~]\<span class="comment"># for NUM in $(seq 0 1 5); do echo var$NUM; done </span></span><br><span class="line">var0</span><br><span class="line">var1</span><br><span class="line">var2</span><br><span class="line">var3</span><br><span class="line">var4</span><br><span class="line">var5</span><br></pre></td></tr></table></figure>
<p>​Shell 脚本在处理完自己的所有内容后，脚本会退出到调用它的进程。若需在脚本执行完成之前退出执行，可以通过在脚本中使用 <code>exit</code> 命令来实现。可以为 exit 命令指定一个参数来表明整个操作的执行状态，其中 <em>0</em> 代表成功执行，其他非零值均代表存在错误。可以使用不同的非零值来代表不同的错误类型，退出后，该命令、脚本进程的执行结果将传回父进程，可以访问变量 <em>？</em> 来获取子进程的执行结果。如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># rmdir DirThatNotExisted</span></span><br><span class="line"><span class="built_in">rmdir</span>: failed to remove <span class="string">&#x27;DirThatNotExisted&#x27;</span>: No such file or directory</span><br><span class="line">[root@localhost ~]\<span class="comment"># echo $?    # ？变量的值是随时根据子进程的执行结果改变的</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果不使用任何参数调用 <code>exit</code> 命令，那么脚本将退出并且将最后执行的命令的退出状态传递给父进程。</p>
</blockquote>
<blockquote>
<p>为确保脚本不会由于意外情况轻易中断，一种良好的做法是不要进行与输入有关的假设，如命令行参数、用户输入、命令替换、变量扩展及文件名扩展。可以使用 Bash 的 test 命令来执行完整性检查。</p>
</blockquote>
<p>​与所有命令一样，<code>test</code> 命令会在完成后生成一个退出代码，该退出代码存储为值 <em>$?</em>。要查看测试的结论，请在执行 <code>test</code> 命令后立即显示 <em>$?</em> 的值。</p>
<h3 id="常用运算符">常用运算符</h3>
<p>​Bash 测试命令语法：<em>[&lt;TESTEXPRESSION&gt;]</em>，较新的扩展测试命令：<em>[&lt;TESTEXPRESSION&gt;]</em>（Bash 2.02 及更高版本可用，可提供诸如通配模式匹配和正则表达式模式匹配等功能）。</p>
<h4 id="算数比较运算符">算数比较运算符</h4>
<table>
<thead>
<tr>
<th>比较运算符</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>num1 <em>-eq</em> num2</td>
<td>等于</td>
<td>[ 1 -eq 1 ]</td>
</tr>
<tr>
<td>num1 <em>-ne</em> num2</td>
<td>不等于</td>
<td>[ 1 -ne 1 ]</td>
</tr>
<tr>
<td>num1 <em>-lt</em> num2</td>
<td>小于</td>
<td>[ 1 -lt 2 ]</td>
</tr>
<tr>
<td>num1 <em>-le</em> num2</td>
<td>小于等于</td>
<td>[ 2 -le 2 ]</td>
</tr>
<tr>
<td>num1 <em>-gt</em> num2</td>
<td>大于</td>
<td>[ 8 -gt 2 ]</td>
</tr>
<tr>
<td>num1 <em>-ge</em> num2</td>
<td>大于等于</td>
<td>[ 2 -gt 2 ]</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># [ 1 -eq 1 ]; echo $?    # -eq：等于，1 等于 1 ？</span></span><br><span class="line">0                                            <span class="comment"># true</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># [ 1 -ne 1 ]; echo $?    # -ne：不等于，1 不等于 1 ？</span></span><br><span class="line">1                                            <span class="comment"># false</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># [ 8 -gt 2 ]; echo $?    # -gt：大于，8 大于 2 ？</span></span><br><span class="line">0                                            <span class="comment"># true</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># [ 2 -ge 2 ]; echo $?    # -ge：大于等于，2 大于等于 2 ？</span></span><br><span class="line">0                                            <span class="comment"># true</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># [ 2 -lt 2 ]; echo $?    # -lt：小于，2 小于 2 ？</span></span><br><span class="line">1                                            <span class="comment"># false</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># [ 1 -lt 2 ]; echo $?    # -lt：小于，1 小于 2 ？</span></span><br><span class="line">0                                            <span class="comment"># true</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># [ 1 -le 2 ]; echo $?    # -le：小于等于，1 小于等于 2 ？</span></span><br><span class="line">0                                            <span class="comment"># true</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串比较运算符">字符串比较运算符</h4>
<blockquote>
<p>注意引号的使用，这是防止空格扰乱代码的好方法。<em>[ <EXPRESSION> ]</em> 语句中两侧的空格以及运算符两侧的空格是必须的。</p>
</blockquote>
<table>
<thead>
<tr>
<th>比较运算符</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>-z</em> string</td>
<td>若 string 长度为 0，则为真</td>
<td>[ -z &quot;$MyVariable&quot; ]</td>
</tr>
<tr>
<td><em>-n</em> string</td>
<td>若 string 长度为 0，则为真</td>
<td>[ -n &quot;$MyVariable&quot; ]</td>
</tr>
<tr>
<td>string1 <em>=</em> string2</td>
<td>若 string1 与 string2 相同，则为真</td>
<td>[ &quot;$MyVariable&quot; = &quot;Some words&quot; ]</td>
</tr>
<tr>
<td>string1 <em>!=</em> string2</td>
<td>若 string1 与 string2 不同，则为真</td>
<td>[ &quot;$MyVariable&quot; != &quot;Some words&quot; ]</td>
</tr>
<tr>
<td>string1 <em>==</em> string2</td>
<td>若 string1 与 string2 相同，则为真</td>
<td>[ &quot;$MyVariable&quot; == &quot;Some words&quot; ]</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># [ abc = abc ]; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ abc == def ]; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ abc != def ]; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ -z &quot;&quot; ]; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ -n &quot;&quot; ]; echo $?</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h4 id="文件比较运算符">文件比较运算符</h4>
<table>
<thead>
<tr>
<th>比较运算符</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>-e</em> filename</td>
<td>若 filename 存在，则为真</td>
<td>[ -e /var/log/syslog ]</td>
</tr>
<tr>
<td><em>-d</em> filename</td>
<td>若 filename 存在，则为真</td>
<td>[ -d /tmp/mydir ]</td>
</tr>
<tr>
<td><em>-f</em> filename</td>
<td>若 filenamee 为常规文件，则为真</td>
<td>[ -f /usr/bin/grep ]</td>
</tr>
<tr>
<td><em>-L</em> filename</td>
<td>若 filename 为符号链接，则为真</td>
<td>[ -L /usr/bin/grep ]</td>
</tr>
<tr>
<td><em>-r</em> filename</td>
<td>若 filename 为可读，则为真</td>
<td>[ -r /var/log/syslog ]</td>
</tr>
<tr>
<td><em>-w</em> filename</td>
<td>若 filename 为可写，则为真</td>
<td>[ -w /root/log.txt ]</td>
</tr>
<tr>
<td><em>-x</em> filename</td>
<td>若 filename 为可执行，则为真</td>
<td>[ -x /usr/bin/grep ]</td>
</tr>
<tr>
<td>filename1 <em>-nt</em> filename2</td>
<td>若 filename1 比 filename2 新，则为真</td>
<td>[ /tmp/install/etc/services -nt /etc/services ]</td>
</tr>
<tr>
<td>filename1 <em>-ot</em> filename2</td>
<td>若 filename1 比 filename2 旧，则为真</td>
<td>[ /boot/bzImage -ot arch/i386/boot/bzImage ]</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># [ -e /var/log/syslog ]; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ -d /tmp/mydir ]; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ -f /usr/bin/grep ]; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ -L /usr/bin/grep ]; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ -r /var/log/syslog ]; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ -w /root/log.txt ]; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ -x /usr/bin/grep ]; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ /tmp/install/etc/services -nt /etc/services ]; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@localhost ~]\<span class="comment"># [ /boot/bzImage -ot arch/i386/boot/bzImage ]; echo $?</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h3 id="脚本编写之条件">脚本编写之条件</h3>
<p>​Bash 中最简单的 <em>if</em> 条件判断语句的格式如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> &lt;CONDITION&gt;; <span class="keyword">then</span></span><br><span class="line">    &lt;STATEMENT&gt;</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>​以下代码段演示使用 if 语句判断若 psacct 服务未处于活动状态则启动该服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># systemctl is-active psacct &gt; /dev/null 2&gt;&amp;1</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># if [ $? -ne 0 ]; then sudo systemctl start psacct; fi</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># </span></span><br></pre></td></tr></table></figure>
<p>​两条线的 <em>if</em> 条件判断语句：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> &lt;CONDITION&gt;; <span class="keyword">then</span></span><br><span class="line">    &lt;STATEMENT&gt;</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    &lt;STATEMENT&gt;</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>​以下代码段演示了使用 <em>if/then/else</em> 语句来启动 <em>psacct</em> 服务（若其未处于活动状态）和停止该服务（如果其处于活动状态）。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># systemctl is-active psacct &gt; /dev/null 2&gt;&amp;1</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># if [ $? -ne 0 ]; then \</span></span><br><span class="line">&gt; sudo systemctl start psacct \</span><br><span class="line">&gt; <span class="keyword">else</span> \</span><br><span class="line">&gt; sudo systemctl stop psacct \</span><br><span class="line">&gt; <span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>​多线的 <em>if</em> 条件判断语句：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> &lt;CONDITION&gt;; <span class="keyword">then</span></span><br><span class="line">    &lt;STATEMENT&gt;</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">elif</span> &lt;CONDITION&gt;; <span class="keyword">then</span></span><br><span class="line">    &lt;STATEMENT&gt;</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">    &lt;STATEMENT&gt;</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>​以下代码段演示了使用 <em>if/then/elif/then/else</em> 语句来运行 mysql 客户端（若 mariadb 服务处于活动状态），运行 psql 客户端（若 postgresql 服务处于活动状态）或运行 sqlite3 客户端（若 mariadb 和 postgresql 服务均未处于活动状态）。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># systemctl is-active mariadb &gt; /dev/null 2&gt;&amp;1</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># MARIADB_ACTIVE=$?</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># sudo systemctl is-active postgresql &gt; /dev/null 2&gt;&amp;1</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># POSTGRESQL_ACTIVE=$?</span></span><br><span class="line">[root@localhost ~]\<span class="comment"># if [ &quot;$MARIADB_ACTIVE&quot; -eq 0 ]; then    \</span></span><br><span class="line">&gt; mysql    \</span><br><span class="line">&gt; <span class="keyword">elif</span> [ <span class="string">&quot;<span class="variable">$POSTGRESQL_ACTIVE</span>&quot;</span> -eq 0 ]; <span class="keyword">then</span> \</span><br><span class="line">&gt; psql \</span><br><span class="line">&gt; <span class="keyword">else</span> \</span><br><span class="line">&gt; sqlite3 \</span><br><span class="line">&gt; <span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h2 id="使用正则表达式">使用正则表达式</h2>
<p>​用法可以参考此网站：<a target="_blank" rel="noopener" href="https://regexr.com/%E3%80%82">https://regexr.com/。</a></p>
<p>​查看配置文件时忽略注释和空白行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]\<span class="comment"># cat /etc/ssh/sshd_config | grep -v &quot;#&quot; | grep -v ^$</span></span><br><span class="line">HostKey /etc/ssh/ssh_host_rsa_key</span><br><span class="line">HostKey /etc/ssh/ssh_host_ecdsa_key</span><br><span class="line">HostKey /etc/ssh/ssh_host_ed25519_key</span><br><span class="line">SyslogFacility AUTHPRIV</span><br><span class="line">PermitRootLogin <span class="built_in">yes</span></span><br><span class="line">AuthorizedKeysFile    .ssh/authorized_keys</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

        </div>
        
<blockquote class="copyright">
    <p><strong>本文链接 : </strong><a class="permalink" href="https://skinyi.github.io/2022-08-15-Linux%20|%20%E6%8F%90%E9%AB%98%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%94%9F%E4%BA%A7%E6%95%88%E7%8E%87.html">https://skinyi.github.io/2022-08-15-Linux | 提高命令行生产效率.html</a></p>
    <p><strong>这篇文章由作者胡编乱造或者由其他文章复制粘贴而来，其中有些内容可能已经过时，请谨慎参考复制文章中的内容。</strong></p>
</blockquote>


    </article>
    
    <section id="comments">
        
    </section>


    

</main>


<aside style="" id="sidebar" class="aside aside-fixture">
    <div class="toc-sidebar">
        <nav id="toc" class="article-toc">
            <h3 class="toc-title">文章目录</h3>
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E7%AE%80%E5%8D%95%E7%9A%84-BASH-%E8%84%9A%E6%9C%AC"><span class="toc-number">1.</span> <span class="toc-text">编写简单的 BASH 脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E8%84%9A%E6%9C%AC%E7%9A%84%E4%B8%A4%E4%B8%AA%E9%A1%BB%E7%9F%A5%E7%82%B9"><span class="toc-number">1.1.</span> <span class="toc-text">编写脚本的两个须知点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%E7%9A%84%E5%AD%97%E9%9D%A2%E5%8C%96%E5%A4%84%E7%90%86"><span class="toc-number">1.1.1.</span> <span class="toc-text">特殊字符的字面化处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E4%BD%BF%E7%94%A8-echo-%E5%91%BD%E4%BB%A4%E6%9D%A5%E8%BE%93%E5%87%BA%E6%89%A7%E8%A1%8C%E7%8A%B6%E6%80%81%E4%BF%A1%E6%81%AF"><span class="toc-number">1.1.2.</span> <span class="toc-text">多使用 echo 命令来输出执行状态信息</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99%E4%B9%8B%E5%BE%AA%E7%8E%AF"><span class="toc-number">1.2.</span> <span class="toc-text">脚本编写之循环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.3.</span> <span class="toc-text">常用运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%95%B0%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.3.1.</span> <span class="toc-text">算数比较运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.3.2.</span> <span class="toc-text">字符串比较运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.3.3.</span> <span class="toc-text">文件比较运算符</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99%E4%B9%8B%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.4.</span> <span class="toc-text">脚本编写之条件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.</span> <span class="toc-text">使用正则表达式</span></a></li></ol>
        </nav>
    </div>
</aside>





        </section>
        <footer class="hidden lg:block fixed bottom-0 left-0 sm:w-1/12 bg-gray-100 z-40">
    
    
        <p class="footer-custom">❤ Powered by <a href="https://hexo.io/" target="_blank" rel="noopener noreferrer">Hexo</a> with <a href="https://github.com/fengkx/hexo-theme-purer" target="_blank" rel="noopener noreferrer">Purer theme</a>.</p>
    
</footer>

        <div id="mask" class="hidden mask fixed inset-0 bg-gray-900 opacity-75 z-40"></div>
        <div id="search-view-container" class="hidden shadow-xl"></div>
        
<script src="/js/dom-event.min.js"></script>



<script src="/js/local-search.min.js"></script>



    <script src="//cdn.jsdelivr.net/npm/lightgallery.js@1.1.3/dist/js/lightgallery.min.js"></script>
    
<script src="/js/light-gallery.min.js"></script>






    </body>
</html>
