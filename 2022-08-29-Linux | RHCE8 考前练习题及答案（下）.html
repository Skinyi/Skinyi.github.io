<!DOCTYPE html>
<html  lang="zh-CN,en,default" >
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    <title>RHCE8 è€ƒå‰ç»ƒä¹ é¢˜åŠç­”æ¡ˆï¼ˆä¸‹ï¼‰ | Avery Ma çš„ä¸ªäººç½‘ç«™</title>
    <meta name="description" content="ğŸ”´ æ­¤æ–‡ç« ç”±ä¹‹å‰çš„ Typora ç¬”è®°è¿ç§»è¿‡æ¥ï¼Œå†…å®¹å¯èƒ½å·²ç»è¿‡æ—¶ã€‚  ï¼ˆæ¥ä¸Šå¸¸è§„é¢˜ï¼‰ ä¿®æ”¹æ–‡ä»¶å†…å®¹ æŒ‰ç…§ä¸‹æ–¹æ‰€è¿°ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;issue.yml çš„ playbook ï¼š   è¯¥ playbook å°†åœ¨æ‰€æœ‰æ¸…å•ä¸»æœºä¸Šè¿è¡Œï¼›   è¯¥ playbook ä¼šå°† &#x2F;etc&#x2F;issue çš„å†…å®¹æ›¿æ¢ä¸ºä¸‹æ–¹æ‰€ç¤ºçš„ä¸€è¡Œæ–‡æœ¬ï¼š  åœ¨ dev ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Šï¼Œè¿™è¡Œæ–‡æœ¬æ˜¾ç¤º">
<meta property="og:type" content="article">
<meta property="og:title" content="RHCE8 è€ƒå‰ç»ƒä¹ é¢˜åŠç­”æ¡ˆï¼ˆä¸‹ï¼‰">
<meta property="og:url" content="https://skinyi.github.io/2022-08-29-Linux%20|%20RHCE8%20%E8%80%83%E5%89%8D%E7%BB%83%E4%B9%A0%E9%A2%98%E5%8F%8A%E7%AD%94%E6%A1%88%EF%BC%88%E4%B8%8B%EF%BC%89.html">
<meta property="og:site_name" content="Avery Ma çš„ä¸ªäººç½‘ç«™">
<meta property="og:description" content="ğŸ”´ æ­¤æ–‡ç« ç”±ä¹‹å‰çš„ Typora ç¬”è®°è¿ç§»è¿‡æ¥ï¼Œå†…å®¹å¯èƒ½å·²ç»è¿‡æ—¶ã€‚  ï¼ˆæ¥ä¸Šå¸¸è§„é¢˜ï¼‰ ä¿®æ”¹æ–‡ä»¶å†…å®¹ æŒ‰ç…§ä¸‹æ–¹æ‰€è¿°ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;issue.yml çš„ playbook ï¼š   è¯¥ playbook å°†åœ¨æ‰€æœ‰æ¸…å•ä¸»æœºä¸Šè¿è¡Œï¼›   è¯¥ playbook ä¼šå°† &#x2F;etc&#x2F;issue çš„å†…å®¹æ›¿æ¢ä¸ºä¸‹æ–¹æ‰€ç¤ºçš„ä¸€è¡Œæ–‡æœ¬ï¼š  åœ¨ dev ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Šï¼Œè¿™è¡Œæ–‡æœ¬æ˜¾ç¤º">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-08-29T15:07:00.394Z">
<meta property="article:modified_time" content="2022-08-30T14:01:20.257Z">
<meta property="article:author" content="skinyi">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="RHEL">
<meta property="article:tag" content="RHCE">
<meta property="article:tag" content="è®¤è¯è€ƒè¯•">
<meta name="twitter:card" content="summary">

    
    <link rel="icon" href="images/favicon.png" type="image/x-icon">

    
<link rel="stylesheet" href="/css/common.min.css">



    
    
    
    
        <link href="//cdn.jsdelivr.net/npm/lightgallery.js@1.1.3/dist/css/lightgallery.min.css" rel="stylesheet">
    
    
    
<link rel="stylesheet" href="/css/iconfont.min.css">

    
<meta name="generator" content="Hexo 6.2.0"></head>

    <body>
        <header class="header header-fixture">
    <div class="profile-search-wrap flex sm:block">
        
        
        <div class="profile sm:text-center md:px-1 lg:px-3 sm:pb-4 sm:pt-6">
            <a id="avatar" role="link" href="https://github.com/skinyi" class="inline-block lg:w-16 lg:h-16 w-8 h-8 m-2" target="_blank" rel="noopener" rel="noreferrer" >
                <img src="/images/avatar.jpg" class="rounded-full" alt="avatar">
            </a>
            <h2 id="name" class="hidden lg:block">Avery Ma</h2>
            <h3 id="title" class="hidden xl:block">IT ä»ä¸šè€…</h3>
            
            <small id="location" class="hidden lg:block">
                <i class="iconfont icon-map-icon"></i>
                å®å¤, ä¸­å›½
            </small>
            
        </div>
        
        
<div class="search flex-1 flex lg:inline-block sm:hidden lg:px-4 lg:mt-2 lg:w-full">
    <form id="search-form" class="my-auto flex-1 lg:border lg:border-solid lg:border-gray-200">
        <div class="input-group table bg-gray-100 lg:bg-white w-full">
            <input id="search-input" type="text" placeholder="æœç´¢" class="inline-block w-full bg-gray-100 lg:bg-white">
            <span class="table-cell">
                <button name="search tigger button" disabled>
                    <i class="iconfont icon-search m-2"></i>
                </button>
            </span>
        </div>
    </form>
        
<div id="content-json" data-placeholder="æœç´¢" class="invisible hidden">/content.json</div>
<script id="search-teamplate" type="text/html" data-path="/content.json">
    <div>
        <div class="search-header bg-gray-400">
            <input id="actual-search-input" model="keyword" ref="input" class="inline-block w-full h-10 px-2 py-1" placeholder="æœç´¢" type="text">
        </div>
        <div class="search-result bg-gray-200">
            {{#each searchPosts}}
            <a href="/{{ path }}" class="result-item block px-2 pb-3 mb-1 pt-1 hover:bg-indigo-100">
                <i class="iconfont icon-file"></i>
                <h1 class="result-title inline font-medium text-lg">{{ title }}</h1>
                <p class="result-content text-gray-600 text-sm">{{{ text }}}</p>
            </a>
            {{/each}}
        </div>
    </div>
</script>

</div>


        <button name="menu toogle button" id="menu-toggle-btn" class="block sm:hidden p-3" role="button" aria-expanded="false">
            <i class="iconfont icon-hamburger"></i>
        </button>
    </div>
    <nav id="menu-nav" class="hidden sm:flex flex-col">
        
        
            <div class="menu-item menu-home" role="menuitem">
                <a href="/.">
                    <i class="iconfont icon-home" aria-hidden="true"></i>
                    <span class="menu-title">é¦–é¡µ</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-archives" role="menuitem">
                <a href="/archives">
                    <i class="iconfont icon-archive" aria-hidden="true"></i>
                    <span class="menu-title">å½’æ¡£</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-categories" role="menuitem">
                <a href="/categories">
                    <i class="iconfont icon-folder" aria-hidden="true"></i>
                    <span class="menu-title">åˆ†ç±»</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-tags" role="menuitem">
                <a href="/tags">
                    <i class="iconfont icon-tag" aria-hidden="true"></i>
                    <span class="menu-title">æ ‡ç­¾</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-repository" role="menuitem">
                <a href="/repository">
                    <i class="iconfont icon-project" aria-hidden="true"></i>
                    <span class="menu-title">é¡¹ç›®</span>
                </a>
            </div>
        
        
            <div class="menu-item menu-about" role="menuitem">
                <a href="/about">
                    <i class="iconfont icon-cup" aria-hidden="true"></i>
                    <span class="menu-title">å…³äº</span>
                </a>
            </div>
        
        

    </nav>
</header>

        <section class="main-section">
            
    <main class="flex-1 px-4 py-14 md:px-5 lg:px-8 lg:py-4 relative min-h-screen">
    

    <article class="content article article-archives article-type-list" itemscope="">
        <header class="article-header">
            
    
        <h1 class="article-title text-lg" itemprop="name">
            RHCE8 è€ƒå‰ç»ƒä¹ é¢˜åŠç­”æ¡ˆï¼ˆä¸‹ï¼‰
        </h1>
    



            <p class="article-meta mb-3 text-xs">
                <span class="article-date">
    <i class="iconfont icon-calendar-check"></i>
	<a href="/2022-08-29-Linux%20%7C%20RHCE8%20%E8%80%83%E5%89%8D%E7%BB%83%E4%B9%A0%E9%A2%98%E5%8F%8A%E7%AD%94%E6%A1%88%EF%BC%88%E4%B8%8B%EF%BC%89.html" class="article-date">
	  <time datetime="2022-08-29T15:07:00.394Z" itemprop="datePublished">8æœˆ 29</time>
	</a>
</span>

                
    <span class="article-category">
    <i class="iconfont icon-folder"></i>
    <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0/">å­¦ä¹ </a> , <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0/Linux/">Linux</a> , <a class="article-category-link" href="/categories/%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/">æ—¥å¸¸è®°å½•</a> , <a class="article-category-link" href="/categories/%E8%BF%81%E7%A7%BB%E6%96%87%E7%AB%A0/">è¿ç§»æ–‡ç« </a>
  </span>


                
    <span class="article-tags">
    <i class="iconfont icon-tag"></i>
    <a class="article-tag-none-link" href="/tags/Linux/" rel="tag">Linux</a>, <a class="article-tag-none-link" href="/tags/RHCE/" rel="tag">RHCE</a>, <a class="article-tag-none-link" href="/tags/RHEL/" rel="tag">RHEL</a>, <a class="article-tag-none-link" href="/tags/%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95/" rel="tag">è®¤è¯è€ƒè¯•</a>
  </span>


                
                
    
        <span class="post-wordcount" itemprop="wordCount">å­—æ•°ç»Ÿè®¡: 2.9k(å­—)</span>
    
    
        <span class="post-readcount" itemprop="timeRequired">é˜…è¯»æ—¶é•¿: 13(åˆ†)</span>
    


            </p>
        </header>
        <div class="marked-body article-body">
            <blockquote>
<p>ğŸ”´ æ­¤æ–‡ç« ç”±ä¹‹å‰çš„ Typora ç¬”è®°è¿ç§»è¿‡æ¥ï¼Œå†…å®¹å¯èƒ½å·²ç»è¿‡æ—¶ã€‚</p>
</blockquote>
<h2 id="ï¼ˆæ¥ä¸Šå¸¸è§„é¢˜ï¼‰">ï¼ˆæ¥ä¸Šå¸¸è§„é¢˜ï¼‰</h2>
<h3 id="ä¿®æ”¹æ–‡ä»¶å†…å®¹">ä¿®æ”¹æ–‡ä»¶å†…å®¹</h3>
<p>æŒ‰ç…§ä¸‹æ–¹æ‰€è¿°ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>/home/greg/ansible/issue.yml</code> çš„ playbook ï¼š</p>
<ol>
<li>
<p>è¯¥ <code>playbook</code> å°†åœ¨æ‰€æœ‰æ¸…å•ä¸»æœºä¸Šè¿è¡Œï¼›</p>
</li>
<li>
<p>è¯¥ <code>playbook</code> ä¼šå°† <code>/etc/issue</code> çš„å†…å®¹æ›¿æ¢ä¸ºä¸‹æ–¹æ‰€ç¤ºçš„ä¸€è¡Œæ–‡æœ¬ï¼š</p>
<ul>
<li>åœ¨ <code>dev</code> ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Šï¼Œè¿™è¡Œæ–‡æœ¬æ˜¾ç¤º ä¸ºï¼š<code>Development</code>;</li>
<li>åœ¨ <code>test</code> ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Šï¼Œè¿™è¡Œæ–‡æœ¬æ˜¾ç¤º ä¸ºï¼š<code>Test</code>;</li>
<li>åœ¨ <code>prod</code> ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Šï¼Œè¿™è¡Œæ–‡æœ¬æ˜¾ç¤º ä¸ºï¼š<code>Production</code>.</li>
</ul>
</li>
</ol>
<p>ğŸ’¯ <strong>ç­”æ¡ˆ</strong>ï¼š</p>
<ol>
<li>åˆ›å»ºå¹¶ç¼–è¾‘å‰§æœ¬ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ vim /home/greg/ansible/issue.yml</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Modify</span> <span class="string">File</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">On</span> <span class="string">dev</span></span><br><span class="line">      <span class="attr">copy:</span></span><br><span class="line">        <span class="attr">content:</span> <span class="string">&quot;Development&quot;</span></span><br><span class="line">        <span class="attr">dest:</span> <span class="string">/etc/issue</span></span><br><span class="line">      <span class="attr">when:</span> <span class="string">&quot;inventory_hostname in groups.dev&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">On</span> <span class="string">test</span></span><br><span class="line">      <span class="attr">copy:</span></span><br><span class="line">        <span class="attr">content:</span> <span class="string">&quot;Test&quot;</span></span><br><span class="line">        <span class="attr">dest:</span> <span class="string">/etc/issue</span></span><br><span class="line">      <span class="attr">when:</span> <span class="string">&quot;inventory_hostname in groups.test&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">On</span> <span class="string">prod</span></span><br><span class="line">      <span class="attr">copy:</span></span><br><span class="line">        <span class="attr">content:</span> <span class="string">&quot;Production&quot;</span></span><br><span class="line">        <span class="attr">dest:</span> <span class="string">/etc/issue</span></span><br><span class="line">      <span class="attr">when:</span> <span class="string">&quot;inventory_hostname in groups.prod&quot;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>æ‰§è¡Œå‰§æœ¬å¹¶éªŒè¯ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ansible]$ ansible-playbook /home/greg/ansible/issue.yml</span><br><span class="line">[greg@control ansible]$ ansible dev,<span class="built_in">test</span>,prod -a <span class="string">&quot;cat /etc/issue&quot;</span>    <span class="comment"># éªŒè¯</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»º-web-å†…å®¹ç›®å½•">åˆ›å»º web å†…å®¹ç›®å½•</h3>
<p>æŒ‰ç…§ä¸‹æ–¹æ‰€è¿°ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>/home/greg/ansible/webcontent.yml</code> çš„ playbook ï¼š</p>
<ol>
<li>
<p>è¯¥ <code>playbook</code> åœ¨ <code>dev</code> ä¸»æœºç»„ä¸­çš„å—ç®¡èŠ‚ç‚¹ä¸Šè¿è¡Œï¼›</p>
</li>
<li>
<p>åˆ›å»ºç¬¦åˆä¸‹åˆ—è¦æ±‚çš„ç›®å½• <code>/webdev</code>:</p>
<ul>
<li>æ‰€æœ‰è€…ä¸º <code>webdev</code> ç»„ï¼›</li>
<li>å…·æœ‰å¸¸è§„æƒé™ï¼š<code>owner=read+write+execute</code>, <code>group=read+write+execute</code>, <code>other=read+execute</code>;</li>
<li>å…·æœ‰ç‰¹æ®Šæƒé™ï¼šè®¾ç½®ç»„ <code>ID</code>;</li>
<li>ç”¨ç¬¦å·é“¾æ¥å°† <code>/var/www/html/webdev</code> é“¾æ¥åˆ° <code>/webdev</code>;</li>
<li>åˆ›å»ºæ–‡ä»¶ <code>/webdev/index.html</code>, å…¶ä¸­åŒ…å«å¦‚ä¸‹æ‰€ç¤ºçš„å•è¡Œæ–‡ä»¶ï¼š <code>Development</code>;</li>
<li>åœ¨ <code>dev</code> ä¸»æœºç»„ä¸­ä¸»æœºä¸Šæµè§ˆæ­¤ç›®å½•ï¼ˆä¾‹å¦‚ <code>http://172.25.250.9/webdev/</code> ï¼‰å°†ç”Ÿæˆä»¥ä¸‹è¾“å‡ºï¼š</li>
</ul>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Development</span><br></pre></td></tr></table></figure>
<p>ğŸ’¯ <strong>ç­”æ¡ˆ</strong>ï¼š</p>
<p>æœ¬é¢˜ä¸­ç”±äºæ¶‰åŠåˆ° web æœåŠ¡å°±éœ€è¦æˆ‘ä»¬è¿›è¡Œå®‰è£… apache å¹¶é…ç½®ä»¥åŠé…ç½®é˜²ç«å¢™å’Œ selinux ç­‰ä¸€ç³»åˆ—å·¥ä½œï¼Œä½†æ˜¯è¿˜å¥½æˆ‘ä»¬ä¹‹å‰åˆ›å»ºè¿‡ä¸€ä¸ª apache è§’è‰²ï¼Œå…¶ä¸­çš„éƒ¨åˆ†æ“ä½œæ»¡è¶³æˆ‘ä»¬æ­¤é¢˜çš„éœ€è¦å› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥æŠŠ apache ä»»åŠ¡éƒ¨åˆ†ç›´æ¥æ‹¿è¿‡æ¥ç”¨ã€‚</p>
<ol>
<li>åˆ›å»ºå¹¶ç¼–å†™å‰§æœ¬ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ vim /home/greg/ansible/webcontent.yml</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">Web</span> <span class="string">Service</span> <span class="string">and</span> <span class="string">Publish</span> <span class="string">Web</span> <span class="string">Content</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Start</span> <span class="string">Firewalld</span> <span class="string">Daemon</span> <span class="string">Service</span></span><br><span class="line">      <span class="attr">service:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">firewalld</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">started</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">Apache</span> <span class="string">Packages</span></span><br><span class="line">      <span class="attr">yum:</span> </span><br><span class="line">        <span class="attr">name:</span> <span class="string">httpd</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Configure</span> <span class="string">Firewall</span></span><br><span class="line">      <span class="attr">firewalld:</span> </span><br><span class="line">        <span class="attr">service:</span> <span class="string">http</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">enabled</span></span><br><span class="line">        <span class="attr">permanent:</span> <span class="literal">yes</span>    <span class="comment"># é˜²ç«å¢™è§„åˆ™æ°¸ä¹…ç”Ÿæ•ˆ</span></span><br><span class="line">        <span class="attr">immediate:</span> <span class="literal">yes</span>    <span class="comment"># é˜²ç«å¢™è§„åˆ™ç«‹å³ç”Ÿæ•ˆï¼ˆå¯èƒ½ä¼šå¤±è´¥ï¼Œè‹¥é˜²ç«å¢™äº‹å…ˆæœªå¼€å¯ï¼‰</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">Group</span> <span class="string">webdav</span></span><br><span class="line">      <span class="attr">group:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">webdav</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">Webdav</span> <span class="string">Directory</span></span><br><span class="line">      <span class="attr">file:</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/webdav</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">webdav</span>     <span class="comment"># éœ€åˆ›å»º webdav ç»„</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="string">&#x27;2775&#x27;</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">directory</span></span><br><span class="line">        <span class="attr">setype:</span> <span class="string">httpd_sys_content_t</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">Link</span> <span class="string">to</span> <span class="string">Webdav</span></span><br><span class="line">      <span class="attr">file:</span></span><br><span class="line">        <span class="attr">src:</span> <span class="string">/webdav</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/var/www/html/webdav</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">link</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Generate</span> <span class="string">index.html</span></span><br><span class="line">      <span class="attr">copy:</span></span><br><span class="line">        <span class="attr">content:</span> <span class="string">&quot;Development&quot;</span></span><br><span class="line">        <span class="attr">dest:</span> <span class="string">/webdav/index.html</span>    <span class="comment"># æ–‡ä»¶ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º</span></span><br><span class="line">        <span class="attr">setype:</span> <span class="string">httpd_sys_content_t</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Enable</span> <span class="string">Auto-start</span> <span class="string">Services</span></span><br><span class="line">      <span class="attr">service:</span> </span><br><span class="line">        <span class="attr">name:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; item &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">restarted</span>    <span class="comment"># é…ç½®é‡å¯è®©æ”¹åŠ¨ç”Ÿæ•ˆ</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">yes</span></span><br><span class="line">      <span class="attr">loop:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">firewalld</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">httpd</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>æ‰§è¡Œå‰§æœ¬å¹¶éªŒè¯ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ansible]$ ansible-playbook /home/greg/ansible/webcontent.yml</span><br><span class="line">[greg@control ansible]$ curl http://node1/webdav/index.html    <span class="comment"># éªŒè¯</span></span><br></pre></td></tr></table></figure>
<h3 id="ç”Ÿæˆç¡¬ä»¶æŠ¥å‘Š">ç”Ÿæˆç¡¬ä»¶æŠ¥å‘Š</h3>
<p>åˆ›å»ºä¸€ä¸ªåä¸º <code>/home/greg/ansible/hwreport.yml</code> çš„ playbook, å®ƒå°†åœ¨æ‰€æœ‰å—ç®¡èŠ‚ç‚¹ä¸Šç”Ÿæˆå«æœ‰ä»¥ä¸‹ä¿¡æ¯çš„è¾“å‡ºæ–‡ä»¶ <code>/root/hwreport.txt</code>:</p>
<ul>
<li>æ¸…å•ä¸»æœºåç§°ï¼›</li>
<li>ä»¥ <code>MB</code> è¡¨ç¤ºçš„æ€»å†…å­˜å¤§å°ï¼›</li>
<li><code>BIOS</code> ç‰ˆæœ¬ï¼›</li>
<li>ç£ç›˜è®¾å¤‡ <code>vda</code> çš„å¤§å°ï¼›</li>
<li>ç£ç›˜è®¾å¤‡ <code>vdb</code> çš„å¤§å°ï¼›</li>
<li>è¾“å‡ºæ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œå«æœ‰ä¸€ä¸ª <code>key=value</code> å¯¹ã€‚</li>
</ul>
<p>æ‚¨çš„ playbook åº”å½“ï¼š</p>
<ul>
<li>ä» <code>http://materials/hwreport.empty</code> ä¸‹è½½æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä¿å­˜ä¸º <code>/root/hwreport.txt</code>;</li>
<li>ä½¿ç”¨æ­£ç¡®çš„å€¼æ”¹ä¸º <code>/root/hwreport.txt</code>;</li>
<li>å¦‚æœç¡¬ä»¶é¡¹ä¸å­˜åœ¨ï¼Œç›¸å…³çš„å€¼åº”è®¾ä¸º <code>NONE</code>.</li>
</ul>
<p>ğŸ’¯ <strong>ç­”æ¡ˆ</strong>ï¼š</p>
<p>æ­¤é¢˜è¦æ±‚åœ¨ playbook ä»»åŠ¡ä¸­å®ç°æ¨¡æ¿æ–‡ä»¶ä¸‹è½½å¹¶æ›¿æ¢å†…å®¹ï¼Œè·ŸåŸæ¥è‡ªå·±äº‹å…ˆä¸‹ä¸‹æ¥å†å¥—ç”¨æ¨¡æ¿çš„æ€è·¯ä¸ä¸€æ ·ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>get_url</code>å’Œ<code>replace</code>æ¨¡å—æ¥å®ç°æ–‡ä»¶ä¸‹è½½å’Œæ–‡ä»¶å†…å®¹æ›¿æ¢ï¼Œå¹¶ä½¿ç”¨ when å…³é”®å­—åˆ¤æ–­ç¡¬ä»¶æ˜¯å¦å­˜åœ¨ã€‚</p>
<ol>
<li>ä¸‹è½½ hwreport.empty äº†è§£å…¶å†…å®¹ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ wget http://materials/hwreport.empty -P /home/greg/ansible</span><br><span class="line">[greg@control ~]$ <span class="built_in">cat</span> hwreport.empty</span><br></pre></td></tr></table></figure>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Hardware report</span></span><br><span class="line"><span class="attr">HOST</span>=inventoryhostname</span><br><span class="line"><span class="attr">MEMORY</span>=memory_in_MB</span><br><span class="line"><span class="attr">BIOS</span>=BIOS_version</span><br><span class="line"><span class="attr">DISK_SIZE_VDA</span>=disk_vda_size</span><br><span class="line"><span class="attr">DISK_SIZE_VDB</span>=disk_vdb_size</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>åˆ›å»ºå¹¶ç¼–è¾‘å‰§æœ¬ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ vim /home/greg/ansible/hwreport.yml</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Generate</span> <span class="string">hwreport</span> <span class="string">on</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Download</span> <span class="string">Template</span> <span class="string">File</span></span><br><span class="line">      <span class="attr">get_url:</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">http://materials/hwreport.empty</span></span><br><span class="line">        <span class="attr">dest:</span> <span class="string">/root/hwreport.txt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Replace</span> <span class="string">Content</span> <span class="string">Of</span> <span class="string">Host</span> <span class="string">Field</span></span><br><span class="line">      <span class="attr">replace:</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/root/hwreport.txt</span></span><br><span class="line">        <span class="attr">regexp:</span> <span class="string">&quot;inventoryhostname&quot;</span></span><br><span class="line">        <span class="attr">replace:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; ansible_hostname &#125;&#125;</span>&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Replace</span> <span class="string">Content</span> <span class="string">Of</span> <span class="string">Memory</span> <span class="string">Field</span></span><br><span class="line">      <span class="attr">replace:</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/root/hwreport.txt</span></span><br><span class="line">        <span class="attr">regexp:</span> <span class="string">&quot;memory_in_MB&quot;</span></span><br><span class="line">        <span class="attr">replace:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; ansible_memtotal_mb|string &#125;&#125;</span>&quot;</span>     <span class="comment"># è§£å†³è­¦å‘Šï¼Œä½¿ç”¨è¿‡æ»¤å™¨è¿›è¡Œ int è½¬ string</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Replace</span> <span class="string">Content</span> <span class="string">Of</span> <span class="string">BIOS</span> <span class="string">Field</span></span><br><span class="line">      <span class="attr">replace:</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/root/hwreport.txt</span></span><br><span class="line">        <span class="attr">regexp:</span> <span class="string">&quot;BIOS_version&quot;</span></span><br><span class="line">        <span class="attr">replace:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; ansible_bios_version &#125;&#125;</span>&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Replace</span> <span class="string">Content</span> <span class="string">Of</span> <span class="string">DISK_SIZE_VDA</span> <span class="string">Field</span></span><br><span class="line">      <span class="attr">replace:</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/root/hwreport.txt</span></span><br><span class="line">        <span class="attr">regexp:</span> <span class="string">&quot;disk_vda_size&quot;</span></span><br><span class="line">        <span class="attr">replace:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; ansible_devices.vda.size | default(&#x27;NONE&#x27;) &#125;&#125;</span>&quot;</span>     <span class="comment"># ä½¿ç”¨è¿‡æ»¤å™¨ï¼Œæœªå®šä¹‰æ—¶ä½¿ç”¨é»˜è®¤å€¼</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Replace</span> <span class="string">Content</span> <span class="string">Of</span> <span class="string">DISK_SIZE_VDB</span> <span class="string">Field</span></span><br><span class="line">      <span class="attr">replace:</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/root/hwreport.txt</span></span><br><span class="line">        <span class="attr">regexp:</span> <span class="string">&quot;disk_vdb_size&quot;</span></span><br><span class="line">        <span class="attr">replace:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; ansible_devices.vdb.size | default(&#x27;NONE&#x27;) &#125;&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>æ‰§è¡Œ playbook å¹¶éªŒè¯ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ansible]$ ansible-playbook /home/greg/ansible/hwreport.yml</span><br><span class="line">[greg@control ansible]$ ansible all -a <span class="string">&quot;cat /root/hwreport.txt&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºå¯†ç åº“">åˆ›å»ºå¯†ç åº“</h3>
<p>æŒ‰ç…§ä¸‹æ–¹æ‰€è¿°ï¼Œåˆ›å»ºä¸€ä¸ª Ansible åº“æ¥å­˜å‚¨ç”¨æˆ·å¯†ç ï¼š</p>
<ol>
<li>
<p>åº“åç§°ä¸º <code>/home/greg/ansible/locker.yml</code>ï¼›</p>
</li>
<li>
<p>åº“ä¸­å«æœ‰ä¸¤ä¸ªå˜é‡ï¼Œåç§°å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>pw_developer</code>, å€¼ä¸º <code>Imadev</code>;</li>
<li><code>pw_manager</code>, å€¼ä¸º <code>Imamgr</code>.</li>
</ul>
</li>
<li>
<p>ç”¨äºåŠ å¯†å’Œè§£å¯†è¯¥åº“çš„å¯†ç ä¸º <code>whenyouwishuponastar</code>ï¼›</p>
</li>
<li>
<p>å¯†ç å­˜å‚¨åœ¨æ–‡ä»¶ <code>/home/greg/ansible/secret.txt</code> ä¸­ã€‚</p>
</li>
</ol>
<p>ğŸ’¯ <strong>ç­”æ¡ˆ</strong>ï¼š</p>
<p>æœ¬é¢˜çš„æ„æ€æ˜¯å¯ä»¥é€šè¿‡åŠ å¯† playbook æ¥è§„é¿æ³„å¯†ç­‰å®‰å…¨é£é™©ï¼Œåœ¨æœ¬é¢˜ä¸­è¢«åŠ å¯†çš„ playbook æ˜¯ <code>/home/greg/ansible/locker.yml</code>ã€‚</p>
<ol>
<li>åˆ›å»ºå¯†ç æ–‡ä»¶å¹¶å°†å¯†æ–‡å†™å…¥æ–‡ä»¶</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ <span class="built_in">echo</span> <span class="string">&quot;whenyouwishuponastar&quot;</span> &gt; /home/greg/ansible/secret.txt</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>åˆ›å»º Ansible åº“å­˜å‚¨ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ <span class="built_in">echo</span> <span class="string">&quot;pw_developer: Imadev\npwmanager: Imamgr\n&quot;</span> &gt; /home/greg/ansible/locker.yml</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>ï¼ˆå¯é€‰ï¼‰å°†å¯†ç æ–‡ä»¶çš„è·¯å¾„å†™å…¥é…ç½®æ–‡ä»¶</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ vim /home/greg/ansible/ansible.cfg</span><br></pre></td></tr></table></figure>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">vault_password_file</span> = /home/greg/ansible/secret.txt</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>åŠ å¯†è¯¥ Ansible åº“æ–‡ä»¶å¹¶éªŒè¯</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ansible]$ ansible-vault encrypt --vault-id=/home/greg/ansible/secret.txt /home/greg/ansible/locker.yml</span><br><span class="line">[greg@control ansible]$ ansible-vault view /home/greg/ansible/locker.yml    <span class="comment"># è§£å¯†éªŒè¯</span></span><br><span class="line">Vault Password: whenyouwishuponastar</span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºç”¨æˆ·è´¦æˆ·">åˆ›å»ºç”¨æˆ·è´¦æˆ·</h3>
<ol>
<li>
<p>ä» <code>http://materials/user_list.yml</code> ä¸‹è½½è¦åˆ›å»ºçš„ç”¨æˆ·çš„åˆ—è¡¨ï¼Œå¹¶å°†å®ƒä¿å­˜åˆ° <code>/home/greg/ansible</code>ï¼›</p>
</li>
<li>
<p>ä½¿ç”¨åœ¨æœ¬æ¬¡è€ƒè¯•ä¸­ä½¿ç”¨åœ¨å…¶ä»–ä½ç½®åˆ›å»ºçš„å¯†ç åº“ <code>/home/greg/ansible/locker.yml</code>ï¼Œåˆ›å»ºåä¸º <code>/home/greg/ansible/users.yml</code> çš„ playbook ï¼Œä»è€ŒæŒ‰ä»¥ä¸‹æ‰€è¿°åˆ›å»ºç”¨æˆ·å¸æˆ·ï¼š</p>
<ol>
<li>
<p>èŒä½æè¿°ä¸º <code>developer</code> çš„ç”¨æˆ·åº”å½“ï¼š</p>
<ul>
<li>åœ¨ <code>dev</code> å’Œ <code>test</code> ä¸»æœºç»„ä¸­çš„å—ç®¡èŠ‚ç‚¹ä¸Šåˆ›å»ºï¼›</li>
<li>ä» <code>pw_developer</code> å˜é‡åˆ†é…å¯†ç ï¼›</li>
<li>æ˜¯è¡¥å……ç»„ <code>devops</code> çš„æˆå‘˜ã€‚</li>
</ul>
</li>
<li>
<p>èŒä½æè¿°ä¸º <code>manager</code> çš„ç”¨æˆ·åº”å½“ï¼š</p>
<ul>
<li>åœ¨ <code>prod</code> ä¸»æœºç»„ä¸­çš„å—ç®¡èŠ‚ç‚¹ä¸Šåˆ›å»ºï¼›</li>
<li>ä» <code>pw_manager</code> å˜é‡åˆ†é…å¯†ç ï¼›</li>
<li>æ˜¯è¡¥å……ç»„ <code>opsmgr</code> çš„æˆå‘˜ã€‚</li>
</ul>
</li>
</ol>
</li>
<li>
<p>å¯†ç é‡‡ç”¨ <code>SHA512</code> å“ˆå¸Œæ ¼å¼ï¼›</p>
</li>
<li>
<p>æ‚¨çš„ playbook åº”èƒ½å¤Ÿåœ¨æœ¬æ¬¡è€ƒè¯•ä¸­ä½¿ç”¨åœ¨å…¶ä»–ä½ç½®åˆ›å»ºçš„åº“å¯†ç æ–‡ä»¶ <code>/home/greg/ansible/secret.txt</code> æ­£å¸¸è¿è¡Œã€‚</p>
</li>
</ol>
<p>ğŸ’¯ <strong>ç­”æ¡ˆ</strong>ï¼š</p>
<ol>
<li>ä¸‹è½½ç”¨æˆ·åˆ—è¡¨æ–‡ä»¶å¹¶åˆ†æ</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ wget http://materials/user_list.yml -P /home/greg/ansible &amp;&amp; <span class="built_in">cat</span> /home/greg/ansible/user_list.yml</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">users:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bob</span></span><br><span class="line">    <span class="attr">job:</span> <span class="string">developer</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sally</span></span><br><span class="line">    <span class="attr">job:</span> <span class="string">manager</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">fred</span></span><br><span class="line">    <span class="attr">job:</span> <span class="string">developer</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>ç¼–å†™ playbook</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ vim /home/greg/ansible/users.yml</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">User</span> <span class="string">on</span> <span class="string">dev,test</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">dev,test</span></span><br><span class="line">  <span class="attr">vars_files:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">/home/greg/ansible/user_list.yml</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/home/greg/ansible/locker.yml</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">Group</span> <span class="string">devops</span></span><br><span class="line">      <span class="attr">group:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">devops</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">User</span> <span class="string">on</span> <span class="string">dev,test</span></span><br><span class="line">      <span class="attr">user:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; item.name &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; pw_developer | password_hash(&#x27;sha512&#x27;) &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">groups:</span> <span class="string">devops</span></span><br><span class="line">        <span class="attr">append:</span> <span class="literal">yes</span>     <span class="comment"># è¿½åŠ é™„åŠ ç»„åˆ°ç°æœ‰çš„é™„åŠ ç»„è®¾ç½®</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">      <span class="attr">loop:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; users &#125;&#125;</span>&quot;</span></span><br><span class="line">      <span class="attr">when:</span> <span class="string">item.job</span> <span class="string">==</span> <span class="string">&#x27;developer&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">User</span> <span class="string">on</span> <span class="string">prod</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">prod</span></span><br><span class="line">  <span class="attr">vars_files:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">/home/greg/ansible/user_list.yml</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/home/greg/ansible/locker.yml</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">Group</span> <span class="string">opsmgr</span></span><br><span class="line">      <span class="attr">group:</span> </span><br><span class="line">        <span class="attr">name:</span> <span class="string">opsmgr</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">User</span> <span class="string">on</span> <span class="string">prod</span></span><br><span class="line">      <span class="attr">user:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; item.name &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; pw_manager | password_hash(&#x27;sha512&#x27;) &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">groups:</span> <span class="string">opsmgr</span></span><br><span class="line">        <span class="attr">append:</span> <span class="literal">yes</span>     <span class="comment"># è¿½åŠ é™„åŠ ç»„åˆ°ç°æœ‰çš„é™„åŠ ç»„è®¾ç½®</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">      <span class="attr">loop:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; users &#125;&#125;</span>&quot;</span></span><br><span class="line">      <span class="attr">when:</span> <span class="string">item.job</span> <span class="string">==</span> <span class="string">&#x27;manager&#x27;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>è¿è¡Œå‰§æœ¬å¹¶éªŒè¯ï¼Œæ³¨æ„ï¼šä¸Šé¢å¼•ç”¨äº†åŠ å¯†çš„æ–‡ä»¶å› æ­¤å¿…é¡»åœ¨å‚æ•°ä¸­æŒ‡å®šå¯†ç æ–‡ä»¶è¿›è¡Œè§£å¯†æ‰èƒ½æ­£å¸¸è¿è¡Œ</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ansible]$ ansible-playbook --vault-password-file=/home/greg/ansible/secret.txt /home/greg/ansible/users.yml</span><br><span class="line">[greg@control ansible]$ ansible dev,<span class="built_in">test</span>,prod -a <span class="string">&quot;tail -2 /etc/passwd&quot;</span>    <span class="comment"># éªŒè¯</span></span><br></pre></td></tr></table></figure>
<h3 id="æ›´æ–°-Ansible-åº“çš„å¯†é’¥">æ›´æ–° Ansible åº“çš„å¯†é’¥</h3>
<p>æŒ‰ç…§ä¸‹æ–¹æ‰€è¿°ï¼Œæ›´æ–°ç°æœ‰ Ansible åº“çš„å¯†é’¥ï¼š</p>
<ul>
<li>ä» <code>http://materials/salaries.yml</code> ä¸‹è½½ Ansible åº“åˆ° <code>/home/greg/ansible</code>;</li>
<li>å½“å‰çš„åº“å¯†ç ä¸º <code>insecure8sure</code>;</li>
<li>æ–°çš„åº“å¯†ç ä¸º <code>bbs2you9527</code>;</li>
<li>åº“ä½¿ç”¨æ–°å¯†ç ä¿æŒåŠ å¯†çŠ¶æ€ã€‚</li>
</ul>
<p>ğŸ’¯ <strong>ç­”æ¡ˆ</strong>ï¼š</p>
<ol>
<li>ä¸‹è½½æ‰€éœ€æ–‡ä»¶å¹¶ä½¿ç”¨å½“å‰åº“å¯†ç è¿›è¡Œè§£å¯†æŸ¥çœ‹</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ wget http://materials/salaries.yml -P /home/greg/ansible</span><br><span class="line">[greg@control ansible]$ ansible-vault view /home/greg/ansible/salaries.yml</span><br><span class="line">Vault Password: insecure8sure</span><br><span class="line">haha    <span class="comment"># èƒ½çœ‹åˆ°è§£å¯†åçš„å†…å®¹</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>é‡æ–°åŠ å¯†æ–‡ä»¶å¹¶ä½¿ç”¨æ–°å¯†ç è¿›è¡Œè§£å¯†æŸ¥çœ‹</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ansible]$ ansible-vault rekey /home/greg/ansible/salaries.yml</span><br><span class="line">Vault Password: insecure8sure</span><br><span class="line">New Vault Password: bbs2you9527</span><br><span class="line">Confirm New Vault Password: bbs2you9527</span><br><span class="line">[greg@control ansible]$ ansible-vault view /home/greg/ansible/salaries.yml</span><br><span class="line">Vault Password: bbs2you9527</span><br><span class="line">haha    <span class="comment"># ç”¨æ–°å¯†ç èƒ½çœ‹åˆ°è§£å¯†åçš„å†…å®¹</span></span><br></pre></td></tr></table></figure>
<h2 id="é™„åŠ é¢˜">é™„åŠ é¢˜</h2>
<h3 id="å®‰è£…-RHEL-è§’è‰²">å®‰è£… RHEL è§’è‰²</h3>
<p>å®‰è£… RHEL â»†â¾Šï¼Œå¹¶ä½¿â½¤ rhel-system-roles.selinux â»†â¾Šï¼Œåˆ›å»ºå‰§æœ¬<code>/home/greg/ansible/selinux.yml</code>ï¼Œè¦æ±‚åœ¨æ‰€æœ‰èŠ‚ç‚¹è¿â¾ï¼Œå°† SELINUX è®¾ç½®ä¸ºå¼ºåˆ¶æ¨¡å¼ã€‚</p>
<p>ğŸ’¯ <strong>ç­”æ¡ˆ</strong>ï¼š</p>
<ol>
<li>å®‰è£… RHEL ç³»ç»Ÿè§’è‰²åŒ…å¹¶ä½¿ç”¨</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ sudo yum install rhel-system-roles -y</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å®‰è£…çš„ Ansible è§’è‰²ä¸€èˆ¬ä¼šæ”¾åœ¨ <code>/usr/share/ansible/roles/</code> ç›®å½•ä¸‹ã€‚åœ¨æœ¬é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„æ˜¯ <code>rhel-system-roles.timesync</code> è¿™ä¸ªè§’è‰²ã€‚<br />
è¦ä½¿ç”¨è¯¥è§’è‰²ï¼Œè¿˜éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å¼•å…¥ï¼Œç¼–è¾‘é…ç½®æ–‡ä»¶<code>/home/greg/ansible/ansible.cfg</code>ï¼Œä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š</p>
</blockquote>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#roles_path = /home/greg/ansible/roles</span></span><br><span class="line"><span class="attr">roles_path</span> = /home/greg/ansible/roles:/usr/share/ansible/roles</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æŸ¥çœ‹æœ¬åœ°è§’è‰²åˆ—è¡¨ï¼š</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ansible]$ ansible-galaxy list</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>ç¼–å†™å‰§æœ¬</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ <span class="built_in">cp</span> /usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml /home/greg/ansible/selinux.yml</span><br><span class="line">[greg@control ~]$ vim /home/greg/ansible/selinux.yml</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">Enforcing</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">    <span class="attr">selinux_policy:</span> <span class="string">targeted</span></span><br><span class="line">    <span class="attr">selinux_state:</span> <span class="string">enforcing</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">rhel-system-roles.selinux</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">apply</span> <span class="string">SElinux</span> <span class="string">role</span></span><br><span class="line">      <span class="attr">block:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">include_role:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">rhel-system-roles.selinux</span></span><br><span class="line">      <span class="attr">rescue:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">check</span></span><br><span class="line">          <span class="attr">fail:</span></span><br><span class="line">          <span class="attr">when:</span> <span class="string">not</span> <span class="string">selinux_reboot_required</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">reboot</span></span><br><span class="line">          <span class="attr">shell:</span> <span class="string">reboot</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">changed</span></span><br><span class="line">          <span class="attr">include_role:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">rhel-system-roles.selinux</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>æ‰§è¡Œå‰§æœ¬å¹¶éªŒè¯</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ansible]$ ansible-playbook /home/greg/ansible/selinux.yml</span><br><span class="line">[greg@control ansible]$ ansible all -a <span class="string">&quot;getenforce&quot;</span>    <span class="comment"># éªŒè¯</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºæ–°çš„ç£ç›˜åˆ†åŒº">åˆ›å»ºæ–°çš„ç£ç›˜åˆ†åŒº</h3>
<p>ç¼–å†™å‰§æœ¬<code>/home/greg/ansible/partition.yml</code>ï¼Œåœ¨ balancers ä¸»æœºä¸Šï¼Œåˆ’åˆ†æ–°çš„ partitionï¼Œ/dev/vddï¼Œç¼–å·1ï¼Œâ¼¤â¼©1500mï¼Œæ ¼å¼åŒ–æˆ ext4ï¼ŒæŒ‚è½½åˆ° /newpart â½¬å½•ï¼Œå¦‚æœç©ºé—´ä¸å¤Ÿï¼Œåˆ†800mï¼Œå¦‚æœæ²¡æœ‰vddï¼ŒæŠ¥é”™ã€‚</p>
<p>ğŸ’¯ <strong>ç­”æ¡ˆ</strong>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ vim /home/greg/ansible/partition.yml</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> </span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">balancers</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">Mount</span> <span class="string">Point</span> <span class="string">Directory</span></span><br><span class="line">      <span class="attr">file:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">/newpart</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">When</span> <span class="string">/dev/vdd</span> <span class="string">Exists</span></span><br><span class="line">      <span class="attr">block:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Try</span> <span class="string">To</span> <span class="string">Make</span> <span class="string">A</span> <span class="string">1500m</span> <span class="string">Partition</span></span><br><span class="line">          <span class="attr">parted:</span></span><br><span class="line">            <span class="attr">device:</span> <span class="string">/dev/vdd</span></span><br><span class="line">            <span class="attr">number:</span> <span class="number">1</span></span><br><span class="line">            <span class="attr">part_end:</span> <span class="string">1500Mib</span></span><br><span class="line">            <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">      <span class="attr">rescue:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Show</span> <span class="string">Error</span> <span class="string">Messages</span></span><br><span class="line">          <span class="attr">debug:</span></span><br><span class="line">            <span class="attr">msg:</span> <span class="string">Could</span> <span class="string">not</span> <span class="string">create</span> <span class="string">partation</span> <span class="string">of</span> <span class="string">that</span> <span class="string">size</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Try</span> <span class="string">To</span> <span class="string">Make</span> <span class="string">A</span> <span class="string">800m</span> <span class="string">Partition</span></span><br><span class="line">          <span class="attr">parted:</span></span><br><span class="line">            <span class="attr">device:</span> <span class="string">/dev/vdd</span></span><br><span class="line">            <span class="attr">number:</span> <span class="number">1</span></span><br><span class="line">            <span class="attr">part_end:</span> <span class="string">800Mib</span></span><br><span class="line">            <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">      <span class="attr">always:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Make</span> <span class="string">File</span> <span class="string">System</span></span><br><span class="line">          <span class="attr">filesystem:</span></span><br><span class="line">            <span class="attr">device:</span> <span class="string">/dev/vdd1</span></span><br><span class="line">            <span class="attr">fstype:</span> <span class="string">ext4</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Mount</span></span><br><span class="line">          <span class="attr">mount:</span></span><br><span class="line">            <span class="attr">src:</span> <span class="string">/dev/vdd1</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/newpart</span></span><br><span class="line">            <span class="attr">fstype:</span> <span class="string">ext4</span></span><br><span class="line">            <span class="attr">state:</span> <span class="string">mounted</span> </span><br><span class="line">      <span class="attr">when:</span> <span class="string">&quot;&#x27;/dev/vdd&#x27; in ansible_facts.devices&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">When</span> <span class="string">/dev/vdd</span> <span class="string">Does</span> <span class="string">not</span> <span class="string">Exist</span></span><br><span class="line">      <span class="attr">debug:</span></span><br><span class="line">        <span class="attr">msg:</span> <span class="string">Disk</span> <span class="string">does</span> <span class="string">not</span> <span class="string">exist</span></span><br><span class="line">      <span class="attr">when:</span> <span class="string">&quot;&#x27;/dev/vdd&#x27; not in ansible_facts.devices&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨-crontab-æ¨¡å—">ä½¿ç”¨ crontab æ¨¡å—</h3>
<p>ç”¨æˆ· jack æ¯ä¸‰ä¸ªâ½‰çš„æ¯å‘¨â½‡æ™šä¸Š 22 ç‚¹ 39 åˆ†æŸ¥çœ‹â¼€æ¬¡â¾ƒâ¾ç”¨æˆ·ç™»å½•æƒ…å†µã€‚</p>
<p>ğŸ’¯ <strong>ç­”æ¡ˆ</strong>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ vim /home/greg/ansible/crontab.yml</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> </span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span></span><br><span class="line">      <span class="attr">cron:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">Login</span> <span class="string">Time</span></span><br><span class="line">        <span class="attr">minute:</span> <span class="string">&quot;39&quot;</span>    <span class="comment">#åˆ†</span></span><br><span class="line">        <span class="attr">hour:</span> <span class="string">&quot;22&quot;</span>    <span class="comment">#æ—¶</span></span><br><span class="line">        <span class="comment"># day: &quot;&quot;     #â½‡</span></span><br><span class="line">        <span class="attr">month:</span> <span class="string">&quot;*/3&quot;</span>    <span class="comment">#â½‰</span></span><br><span class="line">        <span class="attr">weekday:</span> <span class="string">&quot;0&quot;</span>    <span class="comment">#å‘¨</span></span><br><span class="line">        <span class="attr">user:</span> <span class="string">jack</span>    <span class="comment">#æŒ‡å®šâ½¤â¼¾</span></span><br><span class="line">        <span class="attr">job:</span> <span class="string">&quot;(last &amp;&amp; lastb)|grep jack&quot;</span>    <span class="comment">#æ‰§â¾å†…å®¹</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºåˆ°æœŸç”¨æˆ·è´¦æˆ·">åˆ›å»ºåˆ°æœŸç”¨æˆ·è´¦æˆ·</h3>
<p>åˆ›å»ºç”¨æˆ·è´¦æˆ·ï¼Œé»˜è®¤å¯†ç æ˜¯ redhatï¼Œä½¿ç”¨ sha512 æ–¹å¼åŠ å¯†ï¼Œè´¦â¼¾ jackï¼Œæ–°å¢è®¾ç½®å¯†ç æœ‰æ•ˆæœŸä¸º 30 å¤©ã€‚è´¦â¼¾ jonyï¼Œæ–°å¢è®¾ç½®ç›¸åº”çš„ ID 1111ï¼Œâ½¤â¼¾æœ‰æ•ˆæœŸåˆ°2022-01-20ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[greg@control ~]$ vim /home/greg/ansible/create_user.yml</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> </span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">users:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">jack</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">jony</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">User</span></span><br><span class="line">      <span class="attr">user:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; item.name &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; &#x27;redhat&#x27; | password_hash(&#x27;sha512&#x27;) &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">      <span class="attr">loop:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; users &#125;&#125;</span>&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">Password</span> <span class="string">Expired</span> <span class="string">Day</span> <span class="string">of</span> <span class="string">jack</span></span><br><span class="line">      <span class="attr">shell:</span> <span class="string">chage</span> <span class="string">-M</span> <span class="number">30</span> <span class="string">jack</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">User</span> <span class="string">Validity</span> <span class="string">Deadline</span></span><br><span class="line">      <span class="attr">user:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">jony</span></span><br><span class="line">        <span class="attr">uid:</span> <span class="string">&#x27;1111&#x27;</span></span><br><span class="line">        <span class="attr">expires:</span> <span class="string">&#x27;1642636800&#x27;</span>    <span class="comment"># äº‹å…ˆæ‰§è¡Œï¼šdate -d 2022-01-20 +%s è·å¾—</span></span><br></pre></td></tr></table></figure>

        </div>
        
<blockquote class="copyright">
    <p><strong>æœ¬æ–‡é“¾æ¥ : </strong><a class="permalink" href="https://skinyi.github.io/2022-08-29-Linux%20|%20RHCE8%20%E8%80%83%E5%89%8D%E7%BB%83%E4%B9%A0%E9%A2%98%E5%8F%8A%E7%AD%94%E6%A1%88%EF%BC%88%E4%B8%8B%EF%BC%89.html">https://skinyi.github.io/2022-08-29-Linux | RHCE8 è€ƒå‰ç»ƒä¹ é¢˜åŠç­”æ¡ˆï¼ˆä¸‹ï¼‰.html</a></p>
    <p><strong>è¿™ç¯‡æ–‡ç« ç”±ä½œè€…èƒ¡ç¼–ä¹±é€ æˆ–è€…ç”±å…¶ä»–æ–‡ç« å¤åˆ¶ç²˜è´´è€Œæ¥ï¼Œå…¶ä¸­æœ‰äº›å†…å®¹å¯èƒ½å·²ç»è¿‡æ—¶ï¼Œè¯·è°¨æ…å‚è€ƒå¤åˆ¶æ–‡ç« ä¸­çš„å†…å®¹ã€‚</strong></p>
</blockquote>


    </article>
    
    <section id="comments">
        
    </section>


    

</main>


<aside style="" id="sidebar" class="aside aside-fixture">
    <div class="toc-sidebar">
        <nav id="toc" class="article-toc">
            <h3 class="toc-title">æ–‡ç« ç›®å½•</h3>
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E6%8E%A5%E4%B8%8A%E5%B8%B8%E8%A7%84%E9%A2%98%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">ï¼ˆæ¥ä¸Šå¸¸è§„é¢˜ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-number">1.1.</span> <span class="toc-text">ä¿®æ”¹æ–‡ä»¶å†…å®¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-web-%E5%86%85%E5%AE%B9%E7%9B%AE%E5%BD%95"><span class="toc-number">1.2.</span> <span class="toc-text">åˆ›å»º web å†…å®¹ç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E7%A1%AC%E4%BB%B6%E6%8A%A5%E5%91%8A"><span class="toc-number">1.3.</span> <span class="toc-text">ç”Ÿæˆç¡¬ä»¶æŠ¥å‘Š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%86%E7%A0%81%E5%BA%93"><span class="toc-number">1.4.</span> <span class="toc-text">åˆ›å»ºå¯†ç åº“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7"><span class="toc-number">1.5.</span> <span class="toc-text">åˆ›å»ºç”¨æˆ·è´¦æˆ·</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0-Ansible-%E5%BA%93%E7%9A%84%E5%AF%86%E9%92%A5"><span class="toc-number">1.6.</span> <span class="toc-text">æ›´æ–° Ansible åº“çš„å¯†é’¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%8A%A0%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">é™„åŠ é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-RHEL-%E8%A7%92%E8%89%B2"><span class="toc-number">2.1.</span> <span class="toc-text">å®‰è£… RHEL è§’è‰²</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="toc-number">2.2.</span> <span class="toc-text">åˆ›å»ºæ–°çš„ç£ç›˜åˆ†åŒº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-crontab-%E6%A8%A1%E5%9D%97"><span class="toc-number">2.3.</span> <span class="toc-text">ä½¿ç”¨ crontab æ¨¡å—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%88%B0%E6%9C%9F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7"><span class="toc-number">2.4.</span> <span class="toc-text">åˆ›å»ºåˆ°æœŸç”¨æˆ·è´¦æˆ·</span></a></li></ol></li></ol>
        </nav>
    </div>
</aside>





        </section>
        <footer class="hidden lg:block fixed bottom-0 left-0 sm:w-1/12 bg-gray-100 z-40">
    
    
        <p class="footer-custom">â¤ Powered by <a href="https://hexo.io/" target="_blank" rel="noopener noreferrer">Hexo</a> with <a href="https://github.com/fengkx/hexo-theme-purer" target="_blank" rel="noopener noreferrer">Purer theme</a>.</p>
    
</footer>

        <div id="mask" class="hidden mask fixed inset-0 bg-gray-900 opacity-75 z-40"></div>
        <div id="search-view-container" class="hidden shadow-xl"></div>
        
<script src="/js/dom-event.min.js"></script>



<script src="/js/local-search.min.js"></script>



    <script src="//cdn.jsdelivr.net/npm/lightgallery.js@1.1.3/dist/js/lightgallery.min.js"></script>
    
<script src="/js/light-gallery.min.js"></script>






    </body>
</html>
